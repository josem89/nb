{"Name":"Get DNStwist","Description":"","Script":"from SiemplifyAction import SiemplifyAction\nfrom SiemplifyUtils import unix_now, convert_unixtime_to_datetime, output_handler\nfrom ScriptResult import EXECUTION_STATE_COMPLETED, EXECUTION_STATE_FAILED,EXECUTION_STATE_TIMEDOUT\nimport dnstwist\n\n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n\n    param = siemplify.extract_action_param(\"parameter\", print_value=True)\n\n    status = EXECUTION_STATE_COMPLETED  # used to flag back to siemplify system, the action final status\n    output_message = \"output message :\"  # human readable message, showed in UI as the action result\n    result_value = None  # Set a simple result value, used for playbook if\\else and placeholders.\n\n    #fuzz = dnstwist.Fuzzer(\"google.com\")\n    #fuzz.generate()\n    #print(fuzz.domains)\n    \n    url = dnstwist.UrlParser(\"google.com\") # Returns an object with 'domain', 'fragment', 'full_uri', 'password', 'path', 'port', 'query', 'scheme', 'username'\n    #attributes = dir(url)\n    #print(attributes)\n    print(url.full_uri)\n    \n    \n    \n    worker = dnstwist.Scanner(1)\n    #worker.setDaemon(True)\n\n    #kill_received = False\n    #debug = False\n\n    worker.option_extdns = True\n    worker.option_geoip = False\n    worker.option_ssdeep = True\n    worker.option_banners = True\n    worker.option_mxcheck = True\n\n    worker.nameservers = [\"1.1.1.1\"]\n    useragent = \"'Mozilla/5.0 dnsrazzle/%s'\"\n\n    worker.uri_scheme = url.scheme\n    worker.uri_path = url.path\n    worker.uri_query = url.query\n\n    worker.domain_init = url.domain\n    worker.run()\n    #threads.append(worker)\n\n\n    #siemplify.LOGGER.info(\"\\n  status: {}\\n  result_value: {}\\n  output_message: {}\".format(status,result_value, output_message))\n    siemplify.end(output_message, result_value, status)\n\n\nif __name__ == \"__main__\":\n    main()\n\n\n\n","IntegrationIdentifier":"Arnaud Email Utilities","ScriptResultName":"ScriptResult","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{}","ShowResult":true}],"Creator":"d9d122b0-f8e6-4fff-be23-c9dbc7f2a22e","IsEnabled":false,"IsCustom":true,"IsSystem":false,"Version":20.0,"TimeoutSeconds":60,"IsAsync":false,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"parameter","Description":"parameter","Name":"parameter","Value":"parameter","Type":0,"OptionalValues":null,"OptionalValuesJson":null}],"DefaultResultValue":"Success","PythonVersion":"None","SimulationData":{"Entities":null},"SimulationDataJson":null}