{"Name":"Get Pydeep Hash","Description":"","Script":"from SiemplifyAction import SiemplifyAction\nfrom SiemplifyUtils import unix_now, convert_unixtime_to_datetime, output_handler\nfrom ScriptResult import EXECUTION_STATE_COMPLETED, EXECUTION_STATE_FAILED,EXECUTION_STATE_TIMEDOUT\n\nimport pydeep\npydeep.hash_buf('somedata')\npydeep.hash_file('/path/to/file')\npydeep.compare('hash1','hash2')\n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n\n    string_to_hash = siemplify.extract_action_param(\"String to Hash\", print_value=True)\n\n    status = EXECUTION_STATE_COMPLETED  # used to flag back to siemplify system, the action final status\n    output_message = \"Failed to create hash\"\n    result_value = \"Failure\"\n\n    try:\n        result = pyssdeep.get_hash_buffer(string_to_hash)\n    except pyssdeep.FuzzyHashError as err:\n        siemplify.LOGGER.error(err)\n    except TypeError as err:\n        siemplify.LOGGER.error(err)\n    siemplify.LOGGER.info(\"Hash: {}\".format(result))\n    \n    result_value = \"Success\"\n    output_message = \"Successfully created hash {}\".format(result)\n\n    siemplify.end(output_message, result_value, status)\n\nif __name__ == \"__main__\":\n    main()\n","IntegrationIdentifier":"Arnaud Email Utilities","ScriptResultName":"ScriptResult","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"{}","ShowResult":true}],"Creator":"d9d122b0-f8e6-4fff-be23-c9dbc7f2a22e","IsEnabled":false,"IsCustom":true,"IsSystem":false,"Version":11.0,"TimeoutSeconds":30,"IsAsync":false,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[{"CustomActionId":0,"IsMandatory":true,"DefaultValue":"<insert here>","Description":"The content to be hashed","Name":"String to Hash","Value":"<insert here>","Type":0,"OptionalValues":null,"OptionalValuesJson":null}],"DefaultResultValue":"success","PythonVersion":"None","SimulationData":{"Entities":null},"SimulationDataJson":null}