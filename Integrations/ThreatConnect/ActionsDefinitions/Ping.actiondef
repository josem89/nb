{"Name":"Ping","Description":"Test Connectivity","Script":"from SiemplifyUtils import output_handler\nfrom SiemplifyDataModel import EntityTypes\nfrom SiemplifyAction import SiemplifyAction\nfrom ThreatConnectManager import ThreatconnectAPI\n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n\n    conf = siemplify.get_configuration('ThreatConnect')\n    api_access_id = conf['ApiAccessId']\n    api_secret_key = conf['ApiSecretKey']\n    api_default_org = conf['ApiDefaultOrg']\n    api_base_url = conf['ApiBaseUrl']\n    \n    threat_connect = ThreatconnectAPI(api_access_id, api_secret_key, api_default_org, api_base_url)\n    threat_connect.owner = api_default_org\n\n    r = threat_connect.test_connectivity()\n    \n    if r:\n        output_message = \"Connection Established\"\n        result_value = 'true'\n    else:\n        output_message = \"Connection Failed\"\n        result_value = 'false'\n    \n    siemplify.end(output_message, result_value)\n    \n    \nif __name__ == '__main__':\n    main()","IntegrationIdentifier":"ThreatConnect","ScriptResultName":"is_success","DynamicResultsMetadata":null,"Creator":"admin","IsEnabled":true,"IsCustom":true,"IsSystem":false,"Version":0.0,"TimeoutSeconds":600,"IsAsync":null,"AsyncPollingIntervalInSeconds":3600,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[],"DefaultResultValue":null,"PythonVersion":"None","SimulationData":{"Entities":[]},"SimulationDataJson":"{\"Entities\": []}"}