
# VirusTotalV3

VirusTotal was founded in 2004 as a free service that analyzes files and URLs for viruses, worms, trojans and other kinds of malicious content. Our goal is to make the internet a safer place through collaboration between members of the antivirus industry, researchers and end users of all kinds. Fortune 500 companies, governments and leading security companies are all part of the VirusTotal community, which has grown to over 500,000 registered users.This integration was created using the 3rd iteration of VT API.

Python Version - 2
#### Parameters
|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|API Key|None|True|Password|None|
|Verify SSL|None|False|Boolean|true|



## Actions
#### Download File
Download file from VirusTotal. Supported entities: Filehash. Note: this action requires a VT Enterprise token. Only MD5, SHA-1, SHA-256 hashes are supported.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Download Folder Path|Specify the path to the folder, where you want to store the files.|True|String||
|Overwrite|If enabled, action will overwrite the file with the same name.|False|Boolean|true|



##### JSON Results
```json
{"absolute_file_paths": ["/tmp/9498FF82A64FF445398C8426ED63hash", "/tmp/275A021BBFB6489E54D471899F7DB9D1663FC695EC2FE2A2C453hash"]}
```



#### Get Domain Details
Get detailed information about the domain using information from VirusTotal. Supported entities: URL (entity extracts domain part), Hostname.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Engine Threshold|Specify how many engines should mark the domain as malicious or suspicious, for Siemplify to label it as risky. Note: if "Engine Whitelist" contains values, action will only count results from those engines.|False|String||
|Engine Percentage Threshold|Specify the percentage of engines should mark the entity as malicious or suspicious, for Siemplify to label it as suspicious. Note: if "Engine Whitelist" contains values, action will only count the percentage from those engines. If both "Engine Threshold" and "Engine Percentage Threshold" are provided, "Engine Threshold" will be used. Maximum value: 100. Minimum: 0.|False|String||
|Engine Whitelist|Specify a comma-separated list of engines that should be used to retrieve information, whether an entity is malicious or not. Example: AlienVault,Kaspersky. Note: if nothing is specified in this parameter, action will take results from every available engine. If the engine didn't return any information about the entity itâ€™s not going to be counted for the parameters "Engine Threshold" and "Engine Percentage Threshold".|False|String||
|Retrieve Comments|If enabled, action will retrieve comments about the entity.|False|Boolean|true|
|Create Insight|If enabled, action will create an insight containing information about the entities.|False|Boolean|true|
|Only Suspicious Entity Insight|If enabled, action will only create an insight for suspicious entities. Note: parameter "Create Insight" should be enabled.|False|Boolean|false|
|Max Comments To Return|Specify how many comments to return. Default: 10.|False|String|10|
|Widget Theme|Specify the theme for the widget.|False|List|Dark|
|Fetch Widget|If enabled, action will fetch augmented widget related to the entity.|False|Boolean|true|



##### JSON Results
```json
{"results": [{"Entity": "google.com", "EntityResult": {"execution_status": "success", "widget_url": "https://www.virustotal.com/ui/widget/html/", "widget_html": "", "attributes": {"categories": {"Comodo Valkyrie Verdict": "mobile communications", "Forcepoint ThreatSeeker": "search engines and portals", "sophos": "search engines"}, "creation_date": 874296000, "jarm": "27d40d40d29d40d1dc42d43d00041d4689ee210389f4xxxx", "last_analysis_results": {"ADMINUSLabs": {"category": "harmless", "engine_name": "ADMINUSLabs", "method": "blacklist", "result": "clean"},  "zvelo": {"category": "harmless", "engine_name": "zvelo", "method": "blacklist", "result": "clean"}}, "last_analysis_stats": {"harmless": 88, "malicious": 1, "suspicious": 0, "timeout": 0, "undetected": 8}, "last_dns_records": [{"ttl": 299, "type": "A", "value": "108.177.xx.xx"}, {"ttl": 299, "type": "A", "value": "108.177.xx.xx"}], "last_dns_records_date": 1606982024, "last_https_certificate": {"cert_signature": {"signature": "062df2b1e8a6db9375b595367c89186431a88375bdc083538eaec18b895b4bababbe6ecb3f0d57f05b7d3ed1ed270325fbe11c495c3be705fc88e0467ecfa95c5603498b314a4ed75210389929d45761dd33e1af0341350dd020b18e023ffb15e9cf3317c455a39043c370ac1ab8198f67905b359ad9bbad25b2506f698c00d80c0ff950b2526b0cb0ae6bc0502cafb612395959d4d448fea117299ef8392447f2fb76286fb5485b9a6c44769392c934cc5exxxx", "signature_algorithm": "sha256RSA"}, "extensions": {"1.3.6.xx.4.1.xx.2.xx.2": "0481f400f2007700f65c942fd177302214541808309456xxxx", "CA": true, "authority_key_identifier": {"keyid": "98d1f86e10ebcf9bec609f18901bxxxx"}, "ca_information_access": {"CA Issuers": "http://pki.goog/gsr2/GTS1O1.crt", "OCSP": "http://ocsp.pki.goog/gts1o1core"}, "certificate_policies": ["2.xx.xx.1.x.2", "1.3.x.1.x.1.xx.2.x.3"], "crl_distribution_points": ["http://crl.pki.goog/GTS1O1core.crl"], "extended_key_usage": ["serverAuth"], "key_usage": ["ff"], "subject_alternative_name": ["*.google.com", "*.android.com", "*.appengine.google.com", "*.bdn.dev", "*.cloud.google.com", "*.crowdsource.google.com", "*.datacompute.google.com", "*.g.co", "*.gcp.gvt2.com", "*.gcpcdn.gvt1.com", "*.ggpht.cn", "*.gkecnapps.cn", "*.google-analytics.com", "*.google.ca", "*.google.cl", "*.google.co.in", "*.google.co.jp", "*.google.co.uk", "*.google.com.ar", "*.google.com.au", "*.google.com.br", "*.google.com.co", "*.google.com.mx", "*.google.com.tr", "*.google.com.vn", "*.google.de", "*.google.es", "*.google.fr", "*.google.hu", "*.google.it", "*.google.nl", "*.google.pl", "*.google.pt", "*.googleadapis.com", "*.googleapis.cn", "*.googlecnapps.cn", "*.googlecommerce.com", "*.googlevideo.com", "*.gstatic.cn", "*.gstatic.com", "*.gstaticcnapps.cn", "*.gvt1.com", "*.gvt2.com", "*.metric.gstatic.com", "*.urchin.com", "*.url.google.com", "*.wear.gkecnapps.cn", "*.youtube-nocookie.com", "*.youtube.com", "*.youtubeeducation.com", "*.youtubekids.com", "*.yt.be", "*.ytimg.com", "android.clients.google.com", "android.com", "developer.android.google.cn", "developers.android.google.cn", "g.co", "ggpht.cn", "gkecnapps.cn", "goo.gl", "google-analytics.com", "google.com", "googlecnapps.cn", "googlecommerce.com", "source.android.google.cn", "urchin.com", "www.goo.gl", "youtu.be", "youtube.com", "youtubeeducation.com", "youtubekids.com", "yt.be"], "subject_key_identifier": "6332935206e0187513fc382e93836xxxxx", "tags": []}, "issuer": {"C": "US", "CN": "GTS CA 1O1", "O": "Google Trust Services"}, "public_key": {"algorithm": "EC", "ec": {"oid": "secxxx6r1", "pub": "04e39df44fb1e26dcab6784f8521a8eba46172d5e2f2f20c63d6739057d502f189bbdcb9ae72d4ae7fbf8c22d88d75fb8cf717180xxxx"}}, "serial_number": "fbe84f3140566cb602000000xxxx", "signature_algorithm": "sha256RSA", "size": 2423, "subject": {"C": "US", "CN": "*.google.com", "L": "Mountain View", "O": "Google LLC", "ST": "California"}, "tags": [], "thumbprint": "1c0f338c58d42a8ba99da76dc3c968xxxxx", "thumbprint_sha256": "c46e43396e2a7cfe51920db57da32693150735295f2f93804a6xxxx", "validity": {"not_after": "2021-01-26 07:33:42", "not_before": "2020-11-03 07:33:42"}, "version": "V3"}, "last_https_certificate_date": 1606982024, "last_modification_date": 1607006281, "last_update_date": 1568043544, "popularity_ranks": {"Alexa": {"rank": 1, "timestamp": 1606836965}, "Cisco Umbrella": {"rank": 1, "timestamp": 1606923361}, "Majestic": {"rank": 2, "timestamp": 1606923363}, "Quantcast": {"rank": 1, "timestamp": 1585755370}, "Statvoo": {"rank": 1, "timestamp": 1606923361}}, "registrar": "MarkMonitor Inc.", "reputation": 205, "tags": [], "total_votes": {"harmless": 79, "malicious": 19}, "whois": "Admin Country: US\nAdmin Organization: Google LLC\nAdmin State/Province: CA\nCreation Date: 1997-09-15T00:00:00-0700\nCreation Date: 1997-09-15T04:00:00Z\nDNSSEC: unsigned\nDomain Name: GOOGLE.COM\nDomain Name: google.com\nDomain Status: clientDeleteProhibited (https://www.icann.org/epp#clientDeleteProhibited)\nDomain Status: clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited\nDomain Status: clientTransferProhibited (https://www.icann.org/epp#clientTransferProhibited)\nDomain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited\nDomain Status: clientUpdateProhibited (https://www.icann.org/epp#clientUpdateProhibited)\nDomain Status: clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited\nDomain Status: serverDeleteProhibited (https://www.icann.org/epp#serverDeleteProhibited)\nDomain Status: serverDeleteProhibited https://icann.org/epp#serverDeleteProhibited\nDomain Status: serverTransferProhibited (https://www.icann.org/epp#serverTransferProhibited)\nDomain Status: serverTransferProhibited https://icann.org/epp#serverTransferProhibited\nDomain Status: serverUpdateProhibited (https://www.icann.org/epp#serverUpdateProhibited)\nDomain Status: serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited\nName Server: NS1.GOOGLE.COM\nName Server: NS2.GOOGLE.COM\nName Server: NS3.GOOGLE.COM\nName Server: NS4.GOOGLE.COM\nName Server: ns1.google.com\nName Server: ns2.google.com\nName Server: ns3.google.com\nName Server: ns4.google.com\nRegistrant Country: US\nRegistrant Email: ca4484b9e50182bds@\nRegistrant Organization: 3307059bbb3149c4\nRegistrant State/Province: b1952dfc047df18a\nRegistrar Abuse Contact Email: abusecomplaints@markmonitor.com\nRegistrar Abuse Contact Phone: +1.2083895740\nRegistrar Abuse Contact Phone: +1.20838xxxx\nRegistrar IANA ID: 292\nRegistrar Registration Expiration Date: 2028-09-13T00:00:00-0700\nRegistrar URL: http://www.markmonitor.com\nRegistrar WHOIS Server: whois.markmonitor.com\nRegistrar: MarkMonitor Inc.\nRegistrar: MarkMonitor, Inc.\nRegistry Domain ID: 2138xxx_DOMAIN_COM-VRSN\nRegistry Expiry Date: 2028-09-14T04:00:00Z\nTech Country: US\nTech Organization: Google LLC\nTech State/Province: CA\nUpdated Date: 2019-09-09T08:39:04-0700\nUpdated Date: 2019-09-09T15:39:04Z", "whois_date": 1604968125}, "id": "xxxxxx", "links": {"self": "https://www.virustotal.com/api/v3/domains/xxxxx.com"}, "type": "domain", "comments": [{"attributes": {"date": 1606763924, "html": "Its Google!  <br />#Safe #google<br />Please star my profile so my votes count more points thx:)<br />", "tags": ["safe", "google"], "text": "Its Google!  \n#Safe #google\nPlease star my profile so my votes count more points thx:)\n", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "d-google.com-957xxxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/d-google.com-957xxx"}, "type": "comment"}]}}], "is_risky": false}
```



#### Submit File
Submit a file and return results from VirusTotal.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|File Paths|Specify a comma-separated list of absolute file paths. Note: if "Linux Server Address" is specified, action will try to fetch file from remote server.|True|String||
|Engine Threshold|Specify how many engines should mark the file as malicious or suspicious, for Siemplify to label it as risky. Note: if "Engine Whitelist" contains values, action will only count results from those engines.|False|String||
|Engine Percentage Threshold|Specify the percentage of engines should mark the entity as malicious or suspicious, for Siemplify to label it as suspicious. Note: if "Engine Whitelist" contains values, action will only count the percentage from those engines. If both "Engine Threshold" and "Engine Percentage Threshold" are provided, "Engine Threshold" will be used. Maximum value: 100. Minimum: 0.|False|String||
|Engine Whitelist|Specify a comma-separated list of engines that should be used to retrieve information, whether an entity is malicious or not. Example: AlienVault,Kaspersky. Note: if nothing is specified in this parameter, action will take results from every available engine. If the engine didn't return any information about the entity itâ€™s not going to be counted for the parameters "Engine Threshold" and "Engine Percentage Threshold".|False|String||
|Retrieve Comments|If enabled, action will retrieve comments about the entity.|False|Boolean|true|
|Retrieve Sigma Analysis|If enabled, action will retrieve sigma analysis for the file.|False|Boolean|true|
|Max Comments To Return|Specify how many comments to return.|False|String|50|
|Linux Server Address|Specify the IP address of the remote linux server, where the file is located.|False|String||
|Linux Username|Specify the username of the remote linux server, where the file is located.|False|String||
|Linux Password|Specify the password of the remote linux server, where the file is located.|False|Password||



##### JSON Results
```json
{"results": [{"Entity": "/opt/siemplify/siemplify_xxxx/filename.txt", "EntityResult": {"attributes": {"downloadable": false, "exiftool": {"FileType": "TXT", "FileTypeExtension": "txt", "LineCount": "1", "MIMEEncoding": "us-ascii", "MIMEType": "text/plain", "Newlines": "(none)", "WordCount": "5"}, "first_submission_date": 1605871686, "last_analysis_date": 1607708121, "last_analysis_results": {"ALYac": {"category": "undetected", "engine_name": "ALYac", "engine_update": "20201211", "engine_version": "1.1.1.5", "method": "blacklist", "result": null}, "APEX": {"category": "type-unsupported", "engine_name": "APEX", "engine_update": "20201210", "engine_version": "6.107", "method": "blacklist", "result": null}, "Symantec": {"category": "undetected", "engine_name": "Symantec", "engine_update": "20201211", "engine_version": "1.13.0.0", "method": "blacklist", "result": null}, "SymantecMobileInsight": {"category": "type-unsupported", "engine_name": "SymantecMobileInsight", "engine_update": "20200813", "engine_version": "2.0", "method": "blacklist", "result": null}, "TACHYON": {"category": "undetected", "engine_name": "TACHYON", "engine_update": "20201211", "engine_version": "2020-12-11.02", "method": "blacklist", "result": null}, "Tencent": {"category": "undetected", "engine_name": "Tencent", "engine_update": "20201211", "engine_version": "1.0.0.1", "method": "blacklist", "result": null}, "TotalDefense": {"category": "undetected", "engine_name": "TotalDefense", "engine_update": "20201211", "engine_version": "37.1.62.1", "method": "blacklist", "result": null}, "Trapmine": {"category": "type-unsupported", "engine_name": "Trapmine", "engine_update": "20200727", "engine_version": "3.5.0.1023", "method": "blacklist", "result": null}, "TrendMicro": {"category": "undetected", "engine_name": "TrendMicro", "engine_update": "20201211", "engine_version": "11.0.0.1006", "method": "blacklist", "result": null}, "TrendMicro-HouseCall": {"category": "undetected", "engine_name": "TrendMicro-HouseCall", "engine_update": "20201211", "engine_version": "10.0.0.1040", "method": "blacklist", "result": null}, "Trustlook": {"category": "type-unsupported", "engine_name": "Trustlook", "engine_update": "20201211", "engine_version": "1.0", "method": "blacklist", "result": null}, "VBA32": {"category": "undetected", "engine_name": "VBA32", "engine_update": "20201211", "engine_version": "4.4.1", "method": "blacklist", "result": null}, "VIPRE": {"category": "undetected", "engine_name": "VIPRE", "engine_update": "20201211", "engine_version": "88852", "method": "blacklist", "result": null}, "ViRobot": {"category": "undetected", "engine_name": "ViRobot", "engine_update": "20201211", "engine_version": "2014.3.20.0", "method": "blacklist", "result": null}, "Webroot": {"category": "type-unsupported", "engine_name": "Webroot", "engine_update": "20201211", "engine_version": "1.0.0.403", "method": "blacklist", "result": null}, "Yandex": {"category": "undetected", "engine_name": "Yandex", "engine_update": "20201211", "engine_version": "5.5.2.24", "method": "blacklist", "result": null}, "Zillya": {"category": "undetected", "engine_name": "Zillya", "engine_update": "20201210", "engine_version": "2.0.0.4242", "method": "blacklist", "result": null}, "ZoneAlarm": {"category": "undetected", "engine_name": "ZoneAlarm", "engine_update": "20201211", "engine_version": "1.0", "method": "blacklist", "result": null}, "Zoner": {"category": "undetected", "engine_name": "Zoner", "engine_update": "20201211", "engine_version": "0.0.0.0", "method": "blacklist", "result": null}, "eGambit": {"category": "type-unsupported", "engine_name": "eGambit", "engine_update": "20201211", "engine_version": null, "method": "blacklist", "result": null}}, "last_analysis_stats": {"confirmed-timeout": 0, "failure": 0, "harmless": 0, "malicious": 0, "suspicious": 0, "timeout": 0, "type-unsupported": 16, "undetected": 60}, "last_modification_date": 1607708175, "last_submission_date": 1607708121, "magic": "ASCII text, with no line terminators", "md5": "14f7cd7d7236f90f5f89f8c29xxxx", "meaningful_name": "filename.txt", "names": ["filename.txt"], "reputation": 0, "sha1": "18e8b90568bf4a3597d8763369079ab8xxxx", "sha256": "4373067a02da95c57bbc073ac3a68ce33ed11a545dcxxxx", "size": 40, "ssdeep": "3:i1wJDNVYD3uK:i1EDxxxx", "tags": ["text"], "times_submitted": 11, "tlsh": "TNULL", "total_votes": {"harmless": 0, "malicious": 0}, "type_description": "Text", "type_extension": "txt", "type_tag": "text", "unique_sources": 1}, "id": "4373067a02da95c57bbc073ac3a68ce33ed11a545dcxxxx", "links": {"self": "https://www.virustotal.com/api/v3/files/4373067a02da95c57bbc073ac3a68ce33ed11a545dcxxxx"}, "type": "file"}}], "is_risky": false}
```



#### Ping
Test connectivity to the VirusTotal with parameters provided at the integration configuration page on the Marketplace tab.
Timeout - 600 Seconds



#### Get Related Domains
Get related domains to the provided entities from VirusTotal. Note: this action requires a VT Enterprise token. Supported entities: IP, URL, Filehash, Hostname. Note: only MD5, SHA-1 and SHA-256 are supported.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Results|Specify how the JSON result should look like. If "Combined" is selected then action will return all of the unique results that were found among the provided entities. If "Per Entity" is selected, then action will return all of the unique items per entity.|False|List|Combined|
|Max Domains To Return|Specify how many URLs to return. Depending on the parameter "Results", this parameter will behave differently. For "Combined" the limit will define how many results to return from ALL entities. For "Per Entity" this parameter dictates how many results to return per entity. Default: 40.|False|String|40|



##### JSON Results
```json
{"domain": ["192.x.x.xrouter.771xxx.xyz", "192.x.x.xemail.bursxxx.com", "192.x.x.xnetbxx.pbn.nl", "192.x.x.xetherwxxx.io", "192.x.x.xwww.china-chenxxxx.com", "192.x.x.xsmtp1.mail.hxxxx.com.tw", "192.x.x.xwww.cqhonxxxxx.com"], "EntityResults":[{"Entity":"192.xxx.xx.x","EntityResult":["192.xxx.xx.xwww.xxx.com","192.xxx.xx.xtestradu.xxx.playground.ownzones.dev"]},{"Entity":"www.example.com","EntityResult":["xxx.example.com","xxx.example.com"]}]}
```



#### Get Related URLs
Get related urls to the provided entities from VirusTotal. Note: this action requires a VT Enterprise token. Supported entities: IP, URL, Filehash, Hostname. Note: only MD5, SHA-1 and SHA-256 are supported.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Results|Specify how the JSON  result should look like. If "Combined" is selected then action will return all of the unique results that were found among the provided entities. If "Per Entity" is selected, then action will return all of the unique items per entity.|False|List|Combined|
|Max URLs To Return|Specify how many URLs to return. Depending on the parameter "Results", this parameter will behave differently. For "Combined" the limit will define how many results to return from ALL entities. For "Per Entity" this parameter dictates how many results to return per entity. Default: 40.|False|String|40|



##### JSON Results
```json
{"url": ["http://mozcxxxx.ru/test/configif.bin", "http://ctldl.windowsupxxx.com/msdownload/update/v3/static/trustedr/en/disallowxxxx.cab", "http://ctldl.windowsupxxx.com/msdownload/update/v3/static/trustedr/en/disalloxxx.cab?adbe4374axxxx", "http://ctldl.windowsupxxx.com/msdownload/update/v3/static/trustedr/en/authrootstl.cab?5067cf5xxxx", "http://tl.symcd.com/MFEwTzBNMEswSTAJBgUrDgMCGgxxxxxjxN+WY73bfUnSOp7HDKJ/bx0wQUV4abVLi+pimK5PbC4hMYiYXN3LcCEH0bGAxxxxx=", "http://ctldl.windowsupxxx.com/msdownload/update/v3/static/trustedr/en/authrxxxx.cab", "http://t2.symcb.com/MFEwTzBNMEswSTAJBgUrDgMCGgUABBxxxx/yl6nWPkczAQUe1tFz6/Oy3r9MZIaarbzRutXSFACEHGgtzaV3bxxxxx="],"EntityResults":[{"Entity":"192.xxx.xx.xx","EntityResult":["http://www.update-info-account.info/login","http://apple-gps.live/map/?location=xxx"]},{"Entity":"www.example.com","EntityResult":["https://www.example.com/desktopmodules/telerikwebui/radeditorprovider","http://www.example.com/activity/"]}]}
```



#### Search Graphs
Search graphs based on custom filters in VirusTotal.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Query|Specify the query filter for the graph. Please refer to the documentation portal for more details.|True|String||
|Sort Field|Specify what should be the sort field.|False|List|Name|
|Max Graphs To Return|Specify how many graphs to return.|False|String|10|



##### JSON Results
```json
[{"attributes": {"graph_data": {"description": "WannaCry", "version": "5.0.0"}}, "id": "g8a8c71844d5444f98fd3ef10e3ccc94f894c32f05f86417cbxxxxx"}]
```



#### Enrich IP
Enrich IP using information from VirusTotal. Supported entities: IP address.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Only Suspicious Entity Insight|If enabled, action will only create an insight for suspicious entities. Note: parameter "Create Insight" should be enabled.|False|Boolean|false|
|Engine Threshold|Specify how many engines should mark the entity as malicious or suspicious, for Siemplify to label it as suspicious. Note: if "Engine Whitelist" contains values, action will only count results from those engines.|False|String||
|Engine Percentage Threshold|Specify the percentage of engines should mark the entity as malicious or suspicious, for Siemplify to label it as suspicious. Note: if "Engine Whitelist" contains values, action will only count the percentage from those engines. If both "Engine Threshold" and "Engine Percentage Threshold" are provided, "Engine Threshold" will be used. Maximum value: 100. Minimum: 0.|False|String||
|Engine Whitelist|Specify a comma-separated list of engines that should be used to retrieve information, whether an entity is malicious or not. Example: AlienVault,Kaspersky. Note: if nothing is specified in this parameter, action will take results from every available engine. If the engine didn't return any information about the entity itâ€™s not going to be counted for the parameters "Engine Threshold" and "Engine Percentage Threshold".|False|String||
|Retrieve Comments|If enabled, action will retrieve comments about the entity.|False|Boolean|true|
|Create Insight|If enabled, action will create an insight containing information about the entities.|False|Boolean|true|
|Max Comments To Return|Specify how many comments to return. Default: 10|False|String|10|
|Widget Theme|Specify the theme for the widget.|False|List|Dark|
|Fetch Widget|If enabled, action will fetch augmented widget related to the entity.|False|Boolean|true|



##### JSON Results
```json
{"results": [{"Entity": "192.16x.x.x", "EntityResult": {"execution_status": "success", "widget_url": "https://www.virustotal.com/ui/widget/html/", "widget_html": "", "attributes": {"last_analysis_results": {"ADMINUSLabs": {"category": "harmless", "engine_name": "ADMINUSLabs", "method": "blacklist", "result": "clean"}, "AegisLab WebGuard": {"category": "harmless", "engine_name": "AegisLab WebGuard", "method": "blacklist", "result": "clean"}, "AlienVault": {"category": "harmless", "engine_name": "AlienVault", "method": "blacklist", "result": "clean"}, "Antiy-AVL": {"category": "harmless", "engine_name": "Antiy-AVL", "method": "blacklist", "result": "clean"}, "Armis": {"category": "harmless", "engine_name": "Armis", "method": "blacklist", "result": "clean"}, "desenmascara.me": {"category": "harmless", "engine_name": "desenmascara.me", "method": "blacklist", "result": "clean"}, "malwares.com URL checker": {"category": "harmless", "engine_name": "malwares.com URL checker", "method": "blacklist", "result": "clean"}, "securolytics": {"category": "harmless", "engine_name": "securolytics", "method": "blacklist", "result": "clean"}, "zvelo": {"category": "harmless", "engine_name": "zvelo", "method": "blacklist", "result": "clean"}}, "last_analysis_stats": {"harmless": 87, "malicious": 0, "suspicious": 0, "timeout": 0, "undetected": 10}, "last_modification_date": 1606937955, "reputation": 11, "tags": ["private"], "total_votes": {"harmless": 12, "malicious": 1}, "whois": "NetRange: 192.16x.x.x - 192.16x.x.x\nCIDR: 192.16x.x.x/16\nNetName: PRIVATE-ADDRESS-CBLK-RFC1918-IANA-RESERVED\nNetHandle: NET-192-16x-x-x-1\nParent: NET192 (NET-192-0-0-0-0)\nNetType: IANA Special Use\nOriginAS: \nOrganization: Internet Assigned Numbers Authority (IANA)\nRegDate: 1994-03-15\nUpdated: 2013-08-30\nComment: These addresses are in use by many millions of independently operated networks, which might be as small as a single computer connected to a home gateway, and are automatically configured in hundreds of millions of devices. They are only intended for use within a private context and traffic that needs to cross the Internet will need to use a different, unique address.\r\nComment: \r\nComment: These addresses can be used by anyone without any need to coordinate with IANA or an Internet registry. The traffic from these addresses does not come from ICANN or IANA. We are not the source of activity you may see on logs or in e-mail records. Please refer to http://www.iana.org/abuse/answers\r\nComment: \r\nComment: These addresses were assigned by the IETF, the organization that develops Internet protocols, in the Best Current Practice document, RFC 1918 which can be found at:\r\nComment: http://datatracker.ietf.org/doc/rfc1918\nRef: https://rdap.arin.net/registry/ip/192.16x.x.x\nOrgName: Internet Assigned Numbers Authority\nOrgId: IANA\nAddress: 12025 Waterfront Drive\r\nAddress: Suite 300\nCity: Los Angeles\nStateProv: CA\nPostalCode: 90292\nCountry: US\nRegDate: \nUpdated: 2012-08-31\nRef: https://rdap.arin.net/registry/entity/IANA\nOrgTechHandle: IANA-IP-ARIN\nOrgTechName: ICANN\nOrgTechPhone: +1-310-301-5xxx \nOrgTechEmail: abuse@iana.org\nOrgTechRef: https://rdap.arin.net/registry/entity/IANA-IP-ARIN\nOrgAbuseHandle: IANA-IP-ARIN\nOrgAbuseName: ICANN\nOrgAbusePhone: +1-310-301-5xxx \nOrgAbuseEmail: abuse@xxxx.org\nOrgAbuseRef: https://rdap.arin.net/registry/entity/IANA-IP-ARIN\n", "whois_date": 1604797603}, "id": "192.16x.x.x", "links": {"self": "https://www.virustotal.com/api/v3/ip_addresses/192.16x.x.x"}, "type": "ip_address", "comments": [{"attributes": {"date": 1605448527, "html": "normal ip ", "tags": [], "text": "normal ip ", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.16x.x.x-3daxxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-3dxxxx"}, "type": "comment"}, {"attributes": {"date": 1605389242, "html": "common router ip address<br />#safe #ip #network", "tags": ["safe", "ip", "network"], "text": "common router ip address\n#safe #ip #network", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.16x.x.x-495xxxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-495xxxx"}, "type": "comment"}, {"attributes": {"date": 1596742979, "html": "lol", "tags": [], "text": "lol", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.16x.x.x-c98xxxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-c98xxxx"}, "type": "comment"}, {"attributes": {"date": 1593669190, "html": "This IP was carrying out SSH bruteforce attack on 02-Jul-2020 (10:45:06.935387)", "tags": [], "text": "This IP was carrying out SSH bruteforce attack on 02-Jul-2020 (10:45:06.935387)", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.16x.x.x-8018xxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-8018xxx"}, "type": "comment"}, {"attributes": {"date": 1593627348, "html": "This IP was carrying out SSH bruteforce attack on 01-Jul-2020 (16:31:52.434387)", "tags": [], "text": "This IP was carrying out SSH bruteforce attack on 01-Jul-2020 (16:31:52.434387)", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.16x.x.x-9d4xxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-9d4xxx"}, "type": "comment"}, {"attributes": {"date": 1592919494, "html": "This IP was carrying out SSH bruteforce attack on 23-Jun-2020 (12:42:14.959049)", "tags": [], "text": "This IP was carrying out SSH bruteforce attack on 23-Jun-2020 (12:42:14.959049)", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.16x.x.x-c06xxxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-c06xxx"}, "type": "comment"}, {"attributes": {"date": 1592838875, "html": "This IP was carrying out SSH bruteforce attack on 22-Jun-2020 (17:26:46.313363)", "tags": [], "text": "This IP was carrying out SSH bruteforce attack on 22-Jun-2020 (17:26:46.313363)", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.168.x.x-093xxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-093xxx"}, "type": "comment"}, {"attributes": {"date": 1592541570, "html": "This IP was carrying out SSH bruteforce attack on 19-Jun-2020 (09:32:43.439549)", "tags": [], "text": "This IP was carrying out SSH bruteforce attack on 19-Jun-2020 (09:32:43.439549)", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.16x.x.x-40a5xxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-40a5xxx"}, "type": "comment"}, {"attributes": {"date": 1590169005, "html": "<strong>login</strong> interface of routers", "tags": [], "text": "[b]login[/b] interface of routers", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.16x.x.x-ac57xxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-ac57xxx"}, "type": "comment"}, {"attributes": {"date": 1588893055, "html": "A Regular Router IP Adress", "tags": [], "text": "A Regular Router IP Adress", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "i-192.16x.x.x-c53xxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/i-192.16x.x.x-c53xxx"}, "type": "comment"}]}}], "is_risky": false}
```



#### Enrich URL
Enrich URL using information from VirusTotal. Supported entities: URL.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Engine Threshold|Specify how many engines should mark the entity as malicious or suspicious, for Siemplify to label it as suspicious. Note: if "Engine Whitelist" contains values, action will only count results from those engines.|False|String||
|Engine Percentage Threshold|Specify the percentage of engines should mark the entity as malicious or suspicious, for Siemplify to label it as suspicious. Note: if "Engine Whitelist" contains values, action will only count the percentage from those engines. If both "Engine Threshold" and "Engine Percentage Threshold" are provided, "Engine Threshold" will be used. Maximum value: 100. Minimum: 0.|False|String||
|Engine Whitelist|Specify a comma-separated list of engines that should be used to retrieve information, whether an entity is malicious or not. Example: AlienVault,Kaspersky. Note: if nothing is specified in this parameter, action will take results from every available engine. If the engine didn't return any information about the entity itâ€™s not going to be counted for the parameters "Engine Threshold" and "Engine Percentage Threshold".|False|String||
|Resubmit URL|If enabled, action will resubmit urls for analysis instead of using the latest information.|False|Boolean|false|
|Retrieve Comments|If enabled, action will retrieve comments about the entity.|False|Boolean|true|
|Only Suspicious Entity Insight|If enabled, action will only create an insight for suspicious entities. Note: parameter "Create Insight" should be enabled.|False|Boolean|false|
|Create Insight|If enabled, action will create an insight containing information about the entities.|False|Boolean|true|
|Max Comments To Return|Specify how many comments to return. Default: 10.|False|String|10|
|Resubmit After (Days)|Specify how many days since the last submission should pass for the entity to be submitted again. Note: parameter "Resubmit URL" needs to be enabled. Default: 30.|False|String|30|
|Widget Theme|Specify the theme for the widget.|False|List|Dark|
|Fetch Widget|If enabled, action will fetch augmented widget related to the entity.|False|Boolean|true|



##### JSON Results
```json
{"results": [{"Entity": "aHR0cDovLzUuNDUuNzkuMTUvaW5wdXQvP21hcms9MjAyMDAyMDctaGVhbHRoeWJpdGVzZm9ybGlmZS5jb20vMzFtYXdlJnRwbD1YWFhYWFhYWFhYWFhYWFhYWFxxxxxxx", "EntityResult": {"execution_status": "success", "widget_url": "https://www.virustotal.com/ui/widget/html/", "widget_html": "", "attributes": {"categories": {"Dr.Web": "known infection source/not recommended site", "Forcepoint ThreatSeeker": "compromised websites", "sophos": "malware repository, spyware and malware"}, "first_submission_date": 1582300443, "html_meta": {}, "last_analysis_date": 1605440378, "last_analysis_results": {"ADMINUSLabs": {"category": "harmless", "engine_name": "ADMINUSLabs", "method": "blacklist", "result": "clean"}, "AegisLab WebGuard": {"category": "harmless", "engine_name": "AegisLab WebGuard", "method": "blacklist", "result": "clean"}, "AlienVault": {"category": "harmless", "engine_name": "AlienVault", "method": "blacklist", "result": "clean"}, "Antiy-AVL": {"category": "harmless", "engine_name": "Antiy-AVL", "method": "blacklist", "result": "clean"},  "Tencent": {"category": "harmless", "engine_name": "Tencent", "method": "blacklist", "result": "clean"}, "ThreatHive": {"category": "harmless", "engine_name": "ThreatHive", "method": "blacklist", "result": "clean"}, "Threatsourcing": {"category": "harmless", "engine_name": "Threatsourcing", "method": "blacklist", "result": "clean"}, "Trustwave": {"category": "harmless", "engine_name": "Trustwave", "method": "blacklist", "result": "clean"}, "URLhaus": {"category": "harmless", "engine_name": "URLhaus", "method": "blacklist", "result": "clean"}, "VX Vault": {"category": "harmless", "engine_name": "VX Vault", "method": "blacklist", "result": "clean"}, "Virusdie External Site Scan": {"category": "harmless", "engine_name": "Virusdie External Site Scan", "method": "blacklist", "result": "clean"}, "Web Security Guard": {"category": "harmless", "engine_name": "Web Security Guard", "method": "blacklist", "result": "clean"}, "Yandex Safebrowsing": {"category": "harmless", "engine_name": "Yandex Safebrowsing", "method": "blacklist", "result": "clean"}, "ZeroCERT": {"category": "harmless", "engine_name": "ZeroCERT", "method": "blacklist", "result": "clean"}, "desenmascara.me": {"category": "harmless", "engine_name": "desenmascara.me", "method": "blacklist", "result": "clean"}, "malwares.com URL checker": {"category": "harmless", "engine_name": "malwares.com URL checker", "method": "blacklist", "result": "clean"}, "securolytics": {"category": "harmless", "engine_name": "securolytics", "method": "blacklist", "result": "clean"}, "zvelo": {"category": "harmless", "engine_name": "zvelo", "method": "blacklist", "result": "clean"}}, "last_analysis_stats": {"harmless": 66, "malicious": 6, "suspicious": 1, "timeout": 0, "undetected": 7}, "last_final_url": "http://5.45.x.xx/input/?mark=20200207-healthybitesforlife.com/31mawe&tpl=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&engkey=bar+chart+click+event", "last_http_response_code": 404, "last_http_response_content_length": 204, "last_http_response_content_sha256": "58df637d178e35690516bda9e41e245db836170f046041fdxxxxxxx", "last_http_response_headers": {"connection": "keep-alive", "content-length": "204", "content-type": "text/html; charset=iso-8859-1", "date": "Sun, 15 Nov 2020 11:39:39 GMT", "keep-alive": "timeout=60", "server": "nginx"}, "last_modification_date": 1605440389, "last_submission_date": 1605440378, "reputation": 0, "tags": ["ip"], "targeted_brand": {}, "threat_names": ["Mal/HTMLGen-A"], "times_submitted": 4, "title": "404 Not Found", "total_votes": {"harmless": 0, "malicious": 0}, "trackers": {}, "url": "http://5.45.x.xx/input/?mark=20200207-healthybitesforlife.com/31mawe&tpl=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&engkey=bar+chart+click+event"}, "id": "05ef858c49887ce761de6b24bafb0461175acea385e3f4exxxx", "links": {"self": "https://www.virustotal.com/api/v3/urls/05ef858c49887ce761de6b24bafb0461175acea385e3f4e8b114xxxx"}, "type": "url",  "comments": [] }}], "is_risky": true}
```



#### Search Entity Graphs
Search graphs based on the entities in VirusTotal. Supported entities: IP, URL, Filehash, Hostname, Threat Actor, User. Note: only MD5, SHA-1 and SHA-256 are supported.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Sort Field|Specify what should be the sort field.|False|List|Name|
|Max Graphs To Return|Specify how many graphs to return.|False|String|10|



##### JSON Results
```json
[{"attributes": {"graph_data": {"description": "Malware Testing Graph", "version": "5.0.0"}}, "id": "gb0adf6b6dff1441e9baa366620ffae364aeed1bf77cd4bf5b2xxxxx"}, {"attributes": {"graph_data": {"description": "show_derek", "version": "5.0.0"}}, "id": "gf755db149d0343ddbb68f743cad1be40733d2a2914cd4f63xxxxx"}]
```



#### Enrich IOC
Enrich IOCs using information from VirusTotal.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|IOC Type|Specify the type of the IOC.|False|List|Filehash|
|IOCs|Specify a comma-separated list of IOCs for which you want to ingest data.|True|String||
|Widget Theme|Specify the theme for the widget.|False|List|Dark|
|Fetch Widget|If enabled, action will fetch augmented widget related to the entity.|False|Boolean|true|



##### JSON Results
```json
{"iocs":[{"identifier":"9498FF82A64FF445398C84xxxxxxxxxx","details":{"attributes":{"type_description":"Win32 EXE","tlsh":"T1DB44CF267660D833D0DF94316C75C3F9673BFC2123215A6B6A4417699E30xxxxxxxxxx","vhash":"025056657d755510804011z9005b9zxxxxxxxxxx","exiftool":{"SubsystemVersion":"5.1","LinkerVersion":"10.0","ImageVersion":"0.0","ProductName":"ShellExtension","FileVersionNumber":"1.0.1.6","LanguageCode":"English (U.S.)","InternalName":"ShellExtension","FileDescription":"WinMerge Shell Integration","ImageFileCharacteristics":"Executable, 32-bit","CharacterSet":"Unicode","InitializedDataSize":"199168","EntryPoint":"0x39b0","OriginalFileName":"ShellExtension","MIMEType":"application/octet-stream","Subsystem":"Windows GUI","FileVersion":"1.0.1.6","TimeStamp":"2014:09:17 10:34:37+00:00","FileType":"Win32 EXE","PEType":"PE32","FileFlagsMask":"0x003f","ProductVersion":"1.0.1.6","UninitializedDataSize":"0","OSVersion":"5.1","FileOS":"Windows NT 32-bit","LegalCopyright":"Copyright 2003-2013","MachineType":"Intel 386 or later, and compatibles","CompanyName":"MySQL, AB","CodeSize":"54784","FileSubtype":"0","ProductVersionNumber":"1.0.1.6","FileTypeExtension":"exe","ObjectFileType":"Executable application"},"trid":[{"file_type":"Win32 Executable MS Visual C++ (generic)","probability":48.8},{"file_type":"Win64 Executable (generic)","probability":16.4}],"creation_date":1410950077,"names":["ShellExtension","ZeuS_binary_9498FF82A64FF445398C84xxxxxxxxxx.exe"],"signature_info":{"product":"ShellExtension","internal name":"ShellExtension","copyright":"Copyright 2003-2013","original name":"ShellExtension","file version":"1.0.1.6","description":"WinMerge Shell Integration"},"last_modification_date":1645597878,"type_tag":"peexe","capabilities_tags":["win_token","win_files_operation"],"total_votes":{"harmless":3,"malicious":11},"size":254976,"popular_threat_classification":{"suggested_threat_label":"trojan.zbot/foreign","popular_threat_category":[{"count":31,"value":"trojan"}],"popular_threat_name":[{"count":17,"value":"zbot"}]},"authentihash":"ad56160b465f7bd1e7568640397f01fc4f8819ce6f0c1415690ecexxxxxxxxxx","times_submitted":8,"last_submission_date":1572934476,"meaningful_name":"ShellExtension","downloadable":true,"sigma_analysis_summary":{"Sigma Integrated Rule Set (GitHub)":{"high":2,"medium":0,"critical":0,"low":28}},"sandbox_verdicts":{"Zenbox":{"category":"harmless","confidence":1,"sandbox_name":"Zenbox","malware_classification":["CLEAN"]},"VirusTotal ZenBox":{"category":"harmless","confidence":1,"sandbox_name":"VirusTotal ZenBox","malware_classification":["CLEAN"]},"Tencent HABO":{"category":"malicious","sandbox_name":"Tencent HABO","malware_classification":["MALWARE"]}},"sha256":"8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdb1xxxxxxxxxx","type_extension":"exe","tags":["idle","runtime-modules"],"last_analysis_date":1645581939,"unique_sources":8,"first_submission_date":1411582812,"sha1":"36f9ca40b3ce96fcee1cf1d4a72229xxxxxxxxxx","ssdeep":"61xx:Gz90qLc1zR98hUb4UdjzEwG+vqAWiR4EXePxxxxxxxxxx:Gz90qLc1lWhUbhVqxxxxxxxxxx","md5":"9498FF82A64FF445398C84xxxxxxxxxx","pe_info":{"resource_details":[{"lang":"ENGLISH US","entropy":3.271855354309082,"chi2":17094.91796875,"filetype":"Data","sha256":"851381c684c9f0c7b8cb7d0fb0cdf9837b6466b9923bebe0afdccbxxxxxxxxxx","type":"RT_DIALOG"},{"lang":"ENGLISH US","entropy":3.3894574642181396,"chi2":59740.10546875,"filetype":"Data","sha256":"a24783298e931e7949670435824fec4c4b4003f5d5d65f06fe1dcd6655df36ff","type":"RT_VERSION"}],"rich_pe_header_hash":"fa4dbca9180170710b3c24xxxxxxxxxx","imphash":"d7584447a5c5ca9b4a5594xxxxxxxxxx","compiler_product_versions":["[C++] VS2010 SP1 build 40219 count=36","[ASM] VS2010 SP1 build 40219 count=19","[ C ] VS2010 SP1 build 40219 count=110","[IMP] VS2008 SP1 build 30729 count=21","[---] Unmarked objects count=197","id: 175, version: 40219 count=1","[RES] VS2010 SP1 build 40219 count=1","[LNK] VS2010 SP1 build 40219 count=1"],"resource_langs":{"RUSSIAN":1,"ENGLISH US":6},"machine_type":332,"timestamp":1410950077,"debug":[{"codeview":{"age":127,"guid":"a996e137-27e8-4bb8-982f-4dxxxxxxxxxx","name":"H:\\\\generalise\\\\backgroun\\\\device\\\\rpt.pdb","signature":"RSDS"},"offset":145192,"type_str":"IMAGE_DEBUG_TYPE_CODEVIEW","timestamp":"Wed Sep 17 10:34:37 2014","type":2,"size":63}],"resource_types":{"RT_BITMAP":2,"RT_MENU":1,"RT_DIALOG":2,"RT_VERSION":1,"RT_MANIFEST":1},"sections":[{"name":".reloc","chi2":552797.69,"virtual_address":"270xxx","entropy":3.88,"raw_size":6656,"flags":"r","virtual_size":6200,"md5":"4be0d54241ec8f62e48c4xxxxxxxxxxx"}],"import_list":[{"library_name":"USER32.dll","imported_functions":["SetFocus","GetMessageA"]},{"library_name":"WINSPOOL.DRV","imported_functions":["EnumPrintersA","GetPrinterDriverA"]}],"entry_point":14768},"magic":"PE32 executable for MS Windows (GUI) Intel 80386 32-bit","last_analysis_stats":{"harmless":0,"type-unsupported":4,"suspicious":0,"confirmed-timeout":0,"timeout":0,"failure":1,"malicious":58,"undetected":12},"last_analysis_results":{"Bkav":{"category":"malicious","engine_name":"Bkav","engine_version":"1.3.0.9899","result":"W32.AIDetect.malware2","method":"blacklist","engine_update":"20220222"},"Lionic":{"category":"malicious","engine_name":"Lionic","engine_version":"4.2","result":"Trojan.Win32.Zbot.l!c","method":"blacklist","engine_update":"20220223"}},"reputation":-52,"sigma_analysis_stats":{"high":2,"medium":0,"critical":0,"low":28}},"type":"file","id":"8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdb1xxxxxxxxxx","links":{"self":"https://www.virustotal.com/api/v3/files/8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdb1xxxxxxxxxx"},"widget_url":"https://www.virustotal.com/ui/widget/html/OGIyZTcwMWU5MTEwMTk1NWM3Mzg2NTU4OWE0YzcyOTk5YWVhYmMxMTA0M2Y3MTJlMDVmZGIxYzE3YzRhYjE5YXx8ZmlsZXx8eyJiZDEiOiAiIzRkNjM4NSIsICJiZzEiOiAiIzMxM2Q1YSIsICJiZzIiOiAiIzIyMmM0MiIsICJmZzEiOiAiI2ZmZmZmZiIsICJ0eXBlIjogImRlZmF1bHQifXx8ZnVsbHx8Zm91bmR8fDE2NDYyMjI5ODd8fDZmOGFiODI3NzMzMTMxNjU2NTU2ZGE0ZmM3MmNmOThmZGY1ODRjNjNmMGU0OWFiMTlhMTBhOGZiZxxxxxxxxxx","widget_html":"<!DOCTYPE html><html><head></head><body></body></html>"}},{"identifier":"5.45.xx.xxx","details":{"attributes":{"regional_internet_registry":"RIPE NCC","jarm":"2ad2ad20d2ad2ad22c2ad2ad2ad2ad8e917db1de9d33002d7077xxxxxxxxxx","network":"5.45.64.xx/xx","last_https_certificate_date":1627256264,"tags":[],"country":"NL","as_owner":"Scalaxy B.V.","last_analysis_stats":{"harmless":72,"malicious":8,"suspicious":1,"undetected":9,"timeout":0},"asn":58061,"whois_date":1614359729,"last_analysis_results":{"0xSI_f33d":{"category":"undetected","result":"unrated","method":"blacklist","engine_name":"0xSI_f33d"},"Armis":{"category":"harmless","result":"clean","method":"blacklist","engine_name":"Armis"}},"reputation":-96,"last_modification_date":1646176786,"total_votes":{"harmless":0,"malicious":11},"last_https_certificate":{"size":1472,"public_key":{"rsa":{"key_size":2048,"modulus":"00aa8b74f0cc92a85ed4d515abef751a22fd65f2b6b0d33239040a99c65f322f3e833c77540a15ee31dabbd2889dd710ff9d8ccd3b9ea454ca87761cd9ff8a383806986461f8ff764a1202a5ebfb09995cbf40cc11eb2514529704744e6c97a872cde728e278fb140eba3c3aaf60644c8d75fd0048bb506f9b7314e33690f3514598ee45dd366c30a94d6178af91c2784872c162233c66659cea675f22f47752e0877ba5b12a3d800d2e2510d3cc1222c226cee2b85852a7e02da1de2718c746560f3ae05bc6f2d7f1cd6fcdbe37318fc7ddd19ae3486c5f3293946c068735e843fa8467199456d4725ac0b23fc4e0b7b9d3f51c0e16b27542d250xxxxxxxxxxx","exponent":"010001"},"algorithm":"RSA"},"thumbprint_sha256":"406ac0efb0ef67de743b1ab0f4e0352564a7d5ebbd71e3a883c06xxxxxxxxxxx","tags":[],"cert_signature":{"signature":"48ae0d5d0eb411e56bd328b93c7212c72fd21785070648e11d9ae2b80386711699978e650eafa233d234671b87c8134c1c38c59f702518ddebdc7849dc512e0158941507970ab3ab93788d27df728d727d7f9d28ed358abb145fb24803d0eeab04687ae07c7f1d3176374367efc000bd26d3cfc0659e54826ea2dfa2366d7bd9e8ed3bd2ff8a26898b37fadea198f93de8cf3ae3d703513bc0638f7b411d8eda9a3ac9a7510d7bfe553592792d10f8b2c255bc4a05c8c6bfbdb8def045dc754b39c9b89d2a5140818622760eb116abf6fd0a5798c1e274fe56a056ed21f419a6873d314c15238a398d8049b5ecc1ca003d0a07a989a710d137e4fxxxxxxxxxxx","signature_algorithm":"sha256RSA"},"validity":{"not_after":"2021-08-06 23:59:59","not_before":"2020-08-06 00:00:00"},"version":"V3","extensions":{"certificate_policies":["1.3.6.1.4.1.64xx.1.2.x.x","2.23.1xx.1.2.x"],"extended_key_usage":["serverAuth","clientAuth"],"authority_key_identifier":{"keyid":"8d8c5ec454ad8ae177e99bf99b05e1xxxxxxxxxx"},"subject_alternative_name":["y2y-panel.xyz","www.y2y-panel.xyz"],"tags":[],"subject_key_identifier":"4f6429eaccd761eca91d9120b004f9xxxxxxxxxx","key_usage":["ff"],"1.3.6.1.4.1.111xx.2.x.x":"0481f200f00075007d3ef2f88fff88556824c2c0ca9e5289792bcxxxxxxxxxxx","CA":true,"ca_information_access":{"CA Issuers":"http://crt.sectigo.com/SectigoRSADomainValidationSecureServerCA.crt","OCSP":"http://ocsp.sectigo.com"}},"signature_algorithm":"sha256RSA","serial_number":"248562d360bcc919bb9788xxxxxxxxxx","thumbprint":"f9aae62cc9262302e45d94fcc512dxxxxxxxxxxx","issuer":{"C":"GB","ST":"Greater Manchester","CN":"Sectigo RSA Domain Validation Secure Server CA","O":"Sectigo Limited","L":"Salford"},"subject":{"CN":"y2y-panel.xyz"}},"continent":"EU","whois":"NetRange: 5.0.0.0 - 5.255.255.255\\nCIDR: 5.0.0.0/8\\nNetName: RIPE-5\\nNetHandle: NET-5-0-0-0-1\\nParent: ()\\nNetType: Allocated to RIPE NCC\\nOriginAS: \\nOrganization: RIPE Network Coordination Centre (RIPE)\\nRegDate: 2010-11-30\\nUpdated: 2010-12-13\\nComment: These addresses have been further assigned to users in\\nComment: the RIPE NCC region. Contact information can be found in\\nComment: the RIPE database at http://www.ripe.net/whois\\nRef: https://rdap.arin.net/registry/ip/5.0.0.0\\nResourceLink: https://apps.db.ripe.net/search/query.html\\nResourceLink: whois.ripe.net\\nOrgName: RIPE Network Coordination Centre\\nOrgId: RIPE\\nAddress: P.O. Box 10096\\nCity: Amsterdam\\nStateProv: \\nPostalCode: 1001EB\\nCountry: NL\\nRegDate: \\nUpdated: 2013-07-29\\nRef: https://rdap.arin.net/registry/entity/RIPE\\nReferralServer: whois://whois.ripe.net\\nResourceLink: https://apps.db.ripe.net/search/query.html\\nOrgAbuseHandle: ABUSE3850-ARIN\\nOrgAbuseName: Abuse Contact\\nOrgAbusePhone: +31205354444 \\nOrgAbuseEmail: abuse@ripe.net\\nOrgAbuseRef: https://rdap.arin.net/registry/entity/ABUSE3850-ARIN\\nOrgTechHandle: RNO29-ARIN\\nOrgTechName: RIPE NCC Operations\\nOrgTechPhone: +31 20 535 4444 \\nOrgTechEmail: hostmaster@ripe.net\\nOrgTechRef: https://rdap.arin.net/registry/entity/RNO29-ARIN\\ninetnum: 5.45.76.0 - 5.45.79.255\\nnetname: CLOUD-NETWORK-NL\\nremarks: INFRA-AW\\ndescr: ********************************************************\\ndescr: * As ISP we provide IP transit and bandwidth services.\\ndescr: *\\ndescr: * Those services are self managed by our customers\\ndescr: * therefore, we are not using this IP space ourselves\\ndescr: * and it could be assigned to various end customers.\\ndescr: *\\ndescr: * In case of issues related with SPAM, Fraud, Phishing\\ndescr: * DDoS, port scans or others, feel free to contact us\\ndescr: * with relevant info. Abuse email: abuse@ispiria.net\\ndescr: ********************************************************\\ncountry: NL\\norg: ORG-ISPR1-RIPE\\nadmin-c: ISPR1-RIPE\\ntech-c: ISPR1-RIPE\\nstatus: ASSIGNED PA\\nmnt-by: ISPIRIA-MNT\\nmnt-routes: serverius-mnt\\nremarks: ISPIRIA Networks Ltd.\\nremarks: Technical issues: support@ispiria.net\\nremarks: Services request: sales@ispiria.net\\nremarks: Abuse departament: abuse@ispiria.net\\nremarks: Corporate web site: https://ispiria.net\\ncreated: 2013-04-24T11:28:55Z\\nlast-modified: 2019-09-26T09:25:43Z\\nsource: RIPE\\norganisation: ORG-ISPR1-RIPE\\norg-name: ISPIRIA Networks Ltd\\norg-type: OTHER\\naddress: 100 Johnny Grief Dr., Belize city, Belize\\nabuse-c: ACRO15876-RIPE\\nmnt-ref: MNT-3NT\\nmnt-by: ISPIRIA-MNT\\ncreated: 2018-05-03T08:12:15Z\\nlast-modified: 2020-05-22T20:10:44Z\\nsource: RIPE # Filtered\\nperson: James Dickins\\naddress: 100 Johnny Grief Dr., Belize city, Belize\\nphone: +1 (866) 9558855\\nnic-hdl: ISPR1-RIPE\\nmnt-by: ISPIRIA-MNT\\ncreated: 2018-05-03T08:24:33Z\\nlast-modified: 2020-05-19T10:18:30Z\\nsource: RIPE\\nroute: 5.45.76.0/22\\norigin: AS58061\\nmnt-by: ISPIRIA-MNT\\ncreated: 2020-04-24T10:37:38Z\\nlast-modified: 2020-04-24T10:37:38Z\\nsource: RIPE\\n"},"type":"ip_address","id":"5.45.xx.xxx","links":{"self":"https://www.virustotal.com/api/v3/ip_addresses/5.45.xx.xxx"},"widget_url":"https://www.virustotal.com/ui/widget/html/NS40NS43OS4xNXx8aXBfYWRkcmVzc3x8eyJiZDEiOiAiIzRkNjM4NSIsICJiZzEiOiAiIzMxM2Q1YSIsICJiZzIiOiAiIzIyMmM0MiIsICJmZzEiOiAiI2ZmZmZmZiIsICJ0eXBlIjogImRlZmF1bHQifXx8ZnVsbHx8Zm91bmR8fDE2NDYyMjMyMzd8fDhhMDM4MmE2MzQwYzk2NjEwZTM3MTc0YzI5MjIyM2M3MmNiOWJhOGZmMzMzY2Q2MjYxMGExZGE2Mxxxxxxxxxx","widget_html":"<!DOCTYPE html><html><head></head><body></body></html>"}},{"identifier":"test.com","details":{"attributes":{"last_dns_records":[{"type":"NS","value":"dns2.registrar-servers.com","ttl":3600},{"rname":"hostmaster.test.com","retry":7200,"value":"dns101.registrar-servers.com","minimum":86400,"refresh":28800,"expire":604800,"ttl":10800,"serial":1641811000,"type":"SOA"},{"type":"NS","value":"dns102.registrar-servers.com","ttl":3600}],"jarm":"2ad2ad0002ad2ad0002ad2ad2ad2ad83c2e51da709c877942c9xxxxxxxxxxx","whois":"Creation Date: 2013-12-06T02:41:09Z\\nDNSSEC: unsigned\\nDomain Name: test.COM\\nDomain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited\\nDomain Status: redemptionPeriod https://icann.org/epp#redemptionPeriod\\nName Server: DNS101.REGISTRAR-SERVERS.COM\\nName Server: DNS102.REGISTRAR-SERVERS.COM\\nRegistrar Abuse Contact Email: abuse@namecheap.com\\nRegistrar Abuse Contact Phone: +1.6613102107\\nRegistrar IANA ID: 1068\\nRegistrar URL: http://www.namecheap.com\\nRegistrar WHOIS Server: whois.namecheap.com\\nRegistrar: NameCheap, Inc.\\nRegistry Domain ID: 1838126490_DOMAIN_COM-VRSN\\nRegistry Expiry Date: 2021-12-06T02:41:09Z\\nUpdated Date: 2022-01-17T02:52:13Z","last_https_certificate_date":1638686165,"tags":[],"popularity_ranks":{"Cisco Umbrella":{"timestamp":1580139364,"rank":248453}},"last_dns_records_date":1641811567,"last_analysis_stats":{"harmless":78,"malicious":3,"suspicious":0,"undetected":9,"timeout":0},"favicon":{"raw_md5":"8613ef0ac2bc8923a85a6fxxxxxxxxxx","dhash":"1b6799xxxxxxxxxx"},"whois_date":1645002553,"reputation":0,"registrar":"NameCheap, Inc.","last_analysis_results":{"CMC Threat Intelligence":{"category":"harmless","result":"clean","method":"blacklist","engine_name":"CMC Threat Intelligence"},"Snort IP sample list":{"category":"harmless","result":"clean","method":"blacklist","engine_name":"Snort IP sample list"}},"last_update_date":1642387933,"last_modification_date":1646195427,"creation_date":1386297669,"last_https_certificate":{"public_key":{"rsa":{"key_size":2048,"modulus":"00c897b145bf71ae3b27c285283607152a23f2385635a3ca6bcede7f610cf832bebd41eb0c4afc0f0f9cc176cce3307d4dc9dfe6c56797f2ff346604a972c293f108b17711a435bc62a7a33093e2b1290e1dd579b3b14ef73c13c7148e34020b9411413f7b15db88dbec018d8556e9cfe9fa10b0966910094727f323e5fefeb60b208201af27aa114a60867b0863126d2ec36fff43d60b9af2853001c8775e98ccdc7478a5d016a7448af3f0bee097461ecefd3eba7dfc9d9ff73dda8a91e19faa075a9243286273affb8815c3bc80d515e4421a9313ad8dbefb9a0750ac73cfc82708b2a471eb33eac4b0f4ec3cec02cdb309600882d4b49d3d98adxxxxxxxxxxx","exponent":"010001"},"algorithm":"RSA"},"thumbprint_sha256":"ae10b906e8eb7a595e9bca59c88a322f1888edeee24a642a64c7c1xxxxxxxxxx","tags":[],"signature_algorithm":"sha256RSA","subject":{"CN":"raa.namecheap.com"},"validity":{"not_after":"2022-11-29 23:59:59","not_before":"2021-11-04 00:00:00"},"version":"V3","extensions":{"certificate_policies":["1.3.6.1.4.1.64xx.1.2.x.x","2.23.1xx.1.2.x"],"extended_key_usage":["serverAuth","clientAuth"],"tags":[],"subject_alternative_name":["raa.namecheap.com","www.raa.namecheap.com"],"authority_key_identifier":{"keyid":"8d8c5ec454ad8ae177e99bf99b05e1xxxxxxxxxx"},"ca_information_access":{"CA Issuers":"http://crt.sectigo.com/SectigoRSADomainValidationSecureServerCA.crt","OCSP":"http://ocsp.sectigo.com"},"subject_key_identifier":"604abb11b7ef0b58a5a444c1cf0814xxxxxxxxxx","key_usage":["ff"],"1.3.6.1.4.1.111xx.2.x.x":"0482016c016a00770046a555eb75fa912030b5a28969f4f37d11xxxxxxxxxxxx","CA":true},"cert_signature":{"signature_algorithm":"sha256RSA","signature":"06275db636f55c3d11f38ed2fe869cfc0d194533f2fa4ee48b790208f87db73bc92ede5f1629db743afc16341ee43f0ac0e44e16f86d70bd383c8f0cee927d4a53baea044996202a556efcef465ac718f448b7f90529976c536dddbfa37ea72b6fd2fd19701adc0503e24c58d01fee07a997fa419e9aebd85a720ac3a2be02de1ebb9d0fbfed3742f446eb2518305714b532b6fe3368ff05b28feeb10405c643239e1be57c69087b40c92736b06859e43d8963a1b53f0850b40417064ecdcf497ca71aba87047a7d137bea244d3fdf66cac1f0815b85ee010ae7c92d701dc04ead1c81fb3767dd09492e38d71556fc8e2faf4866a8d40e61297d7dxxxxxxxxxx"},"serial_number":"31d763c4fdab90f2875bd1xxxxxxxxxx","thumbprint":"004a44ff4929e5fd91538276fe45fbxxxxxxxxxx","issuer":{"C":"GB","L":"Salford","CN":"Sectigo RSA Domain Validation Secure Server CA","O":"Sectigo Limited","ST":"Greater Manchester"},"size":1608},"categories":{"Webroot":"Phishing and Other Frauds","Comodo Valkyrie Verdict":"media sharing","Forcepoint ThreatSeeker":"bot networks"},"total_votes":{"harmless":0,"malicious":0}},"type":"domain","id":"test.com","links":{"self":"https://www.virustotal.com/api/v3/domains/test.com"},"widget_url":"https://www.virustotal.com/ui/widget/html/bWFya29zc29sb21vbi5jb218fGRvbWFpbnx8eyJiZDEiOiAiIzRkNjM4NSIsICJiZzEiOiAiIzMxM2Q1YSIsICJiZzIiOiAiIzIyMmM0MiIsICJmZzEiOiAiI2ZmZmZmZiIsICJ0eXBlIjogImRlZmF1bHQifXx8ZnVsbHx8Zm91bmR8fDE2NDYyMjM0NDJ8fDI0OWZmZGZmNmE3N2JiNDg0ZWQ4MDlmNjk0ZjFhZmRhY2ZhYmVhMWJkOWVjMGNiMjJlZWRkOGM4xxxxxxxxxxx","widget_html":"<!DOCTYPE html><html><head></head><body></body></html>"}},{"identifier":"https://jsonlint.com/","details":{"attributes":{"favicon":{"raw_md5":"8edf857a9d7fec7adc627xxxxxxxxxxx","dhash":"000000xxxxxxxxxx"},"last_modification_date":1646031287,"times_submitted":196,"total_votes":{"harmless":0,"malicious":0},"threat_names":[],"last_submission_date":1646030550,"last_http_response_content_length":16063,"last_http_response_headers":{"transfer-encoding":"chunked","cf-cache-status":"HIT","vary":"Accept-Encoding","last-modified":"Tue, 01 Feb 2022 22:07:06 GMT","link":"</css/style-1.css>; rel=preload; as=style","report-to":{"endpoints":[{"url":"https:\\\\/\\\\/a.nel.cloudflare.com\\\\/report\\\\/v3?s=KOr5NdjXWyZnJBiC%2BUQgHNyK44r7irlJW8%2Fv3iQ7pEnLt4jQ9AWKR%2BNNdZhgxvQE0fibELaKi0SVhhyDZHGeNUAdiQSI%2BkOc5447gvdUdYH7fT8y2A%2FPANRd9nE60Q%3D%3D"}],"group":"cf-nel","max_age":604800},"date":"Mon, 28 Feb 2022 06:49:10 GMT","cf-ray":"6e47b620ab7a62fa-ORD","access-control-allow-origin":"*","expect-ct":"max-age=604800","report-uri":"https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct","nel":{"success_fraction":0,"report_to":"cf-nel","max_age":604800},"content-encoding":"br","strict-transport-security":"max-age=15768000","server":"cloudflare","connection":"keep-alive","cache-control":"max-age=14400","content-type":"text/html"},"reputation":0,"tags":[],"last_analysis_date":1646030550,"has_content":false,"first_submission_date":1494403073,"categories":{"Forcepoint ThreatSeeker":"information technology","Sophos":"information technology","alphaMountain.ai":"Information Technology","Comodo Valkyrie Verdict":"mobile communications","BitDefender":"computersandsoftware"},"last_http_response_content_sha256":"fb73ff6938ef4095b0be1b6e922b636bf612b67edd58a44d8d47c1xxxxxxxxxx","last_http_response_code":200,"last_final_url":"https://jsonlint.com/","trackers":{"Google Analytics":[{"url":"https://www.google-analytics.com/analytics.js","timestamp":1646030550,"id":"UA-69209117-1"}]},"url":"https://jsonlint.com/","title":"JSON Online Validator and Formatter - JSON Lint","last_analysis_stats":{"harmless":84,"malicious":0,"suspicious":0,"undetected":9,"timeout":0},"last_analysis_results":{"CMC Threat Intelligence":{"category":"harmless","result":"clean","method":"blacklist","engine_name":"CMC Threat Intelligence"},"Snort IP sample list":{"category":"harmless","result":"clean","method":"blacklist","engine_name":"Snort IP sample list"}},"html_meta":{"google-site-verification":["T1nWWoSoh2qccuR4z4J2MH9AuFVnl7vQHxxxxxxxxxx"],"description":["JSONLint is the free online validator and reformatter tool for JSON, a lightweight data-interchange format."],"viewport":["width=device-width,initial-scale=1"],"robots":["index"]},"outgoing_links":["https://jsonlint.memberful.com/checkout?plan=21158","https://dns-lookup.com/","http://www.crockford.com/","https://jsoncompare.com/","https://github.com/zaach/jsonlint","https://www.json.org/","https://www.github.com/circlecell/jsonlintdotcom","https://www.buysellads.com/buy/detail/266667/zone/1303970","https://randomkeygen.com/","https://jscompress.com/","https://validatejavascript.com/","http://zaa.ch/"]},"type":"url","id":"91ea0979b401289efe3c586df3275aebdd12dcdaf4c7c10b68b1cxxxxxxxxxxx","links":{"self":"https://www.virustotal.com/api/v3/urls/91ea0979b401289efe3c586df3275aebdd12dcdaf4c7c10b68b1cxxxxxxxxxxx"},"widget_url":null,"widget_html":null}}]}
```



#### Enrich Hash
Enrich Hash using information from VirusTotal. Supported entities: Filehash. Note: only MD5, SHA-1 and SHA-256 are supported.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Engine Threshold|Specify how many engines should mark the entity as malicious or suspicious, for Siemplify to label it as suspicious. Note: if "Engine Whitelist" contains values, action will only count results from those engines.|False|String||
|Engine Percentage Threshold|Specify the percentage of engines should mark the entity as malicious or suspicious, for Siemplify to label it as suspicious. Note: if "Engine Whitelist" contains values, action will only count the percentage from those engines. If both "Engine Threshold" and "Engine Percentage Threshold" are provided, "Engine Threshold" will be used. Maximum value: 100. Minimum: 0.|False|String||
|Engine Whitelist|Specify a comma-separated list of engines that should be used to retrieve information, whether an entity is malicious or not. Example: AlienVault,Kaspersky. Note: if nothing is specified in this parameter, action will take results from every available engine. If the engine didn't return any information about the entity itâ€™s not going to be counted for the parameters "Engine Threshold" and "Engine Percentage Threshold".|False|String||
|Resubmit Hash|If enabled, action will resubmit hashes for analysis instead of using the latest information.|False|Boolean|false|
|Resubmit After (Days)|Specify how many days since the last submission should pass for the entity to be submitted again. Note: parameter "Resubmit Hash" needs to be enabled.|False|String|30|
|Retrieve Comments|If enabled, action will retrieve comments about the entity.|False|Boolean|true|
|Retrieve Sigma Analysis|If enabled, action will retrieve sigma analysis for the hash.|False|Boolean|true|
|Sandbox|Specify a comma-separated list of sandbox names that should be used for behavior analysis. If nothing is provided, action will only use the "VirusTotal Jujubox" sandbox. Make sure that the spelling is correct. Examples of sandboxes: VirusTotal Jujubox, VirusTotal ZenBox, Microsoft Sysinternals, Tencent HABO.|False|String|VirusTotal Jujubox|
|Retrieve Sandbox Analysis|If enabled, action will fetch sandbox analysis for the entity. For each sandbox, action will create a separate section in the JSON result. Action will only return data for the sandboxes that are provided in the parameter "Sandbox".|False|Boolean|true|
|Create Insight|If enabled, action will create an insight containing information about the entities.|False|Boolean|true|
|Only Suspicious Entity Insight|If enabled, action will only create an insight for suspicious entities. Note: parameter "Create Insight" should be enabled.|False|Boolean|false|
|Max Comments To Return|Specify how many comments to return. Default: 10.|False|String|10|
|Widget Theme|Specify the theme for the widget.|False|List|Dark|
|Fetch Widget|If enabled, action will fetch augmented widget related to the entity.|False|Boolean|true|



##### JSON Results
```json
{"results": [{"Entity": "8b2e701e91101955c73865589a4c72999aeabc11043f7xxxxx", "EntityResult": {"attributes": {"authentihash": "ad56160b465f7bd1e7568640397f01fc4f8819ce6f0c141569xxxx", "creation_date": 1410950077, "downloadable": true, "exiftool": {"CharacterSet": "Unicode", "CodeSize": "547xx", "CompanyName": "MySQL, AB", "EntryPoint": "0x39xx", "FileDescription": "WinMerge Shell Integration", "FileFlagsMask": "0x00xx", "FileOS": "Windows NT 32-bit", "FileSubtype": "0", "FileType": "Win32 EXE", "FileTypeExtension": "exe", "FileVersion": "1.0.1.6", "FileVersionNumber": "1.0.1.6", "ImageFileCharacteristics": "Executable, 32-bit", "ImageVersion": "0.0", "InitializedDataSize": "199168", "InternalName": "ShellExtension", "LanguageCode": "English (U.S.)", "LegalCopyright": "Copyright 2003-2013", "LinkerVersion": "10.0", "MIMEType": "application/octet-stream", "MachineType": "Intel 386 or later, and compatibles", "OSVersion": "5.1", "ObjectFileType": "Executable application", "OriginalFileName": "ShellExtension", "PEType": "PE32", "ProductName": "ShellExtension", "ProductVersion": "1.0.1.6", "ProductVersionNumber": "1.0.1.6", "Subsystem": "Windows GUI", "SubsystemVersion": "5.1", "TimeStamp": "2014:09:17 10:34:37+00:00", "UninitializedDataSize": "0"}, "first_submission_date": 1411582812, "last_analysis_date": 1606903659, "last_analysis_results": {"ALYac": {"category": "malicious", "engine_name": "ALYac", "engine_update": "20201202", "engine_version": "1.1.1.5", "method": "blacklist", "result": "Trojan.Foreign.Gen.2"}, "eGambit": {"category": "malicious", "engine_name": "eGambit", "engine_update": "20201202", "engine_version": null, "method": "blacklist", "result": "Generic.Trojan"}}, "last_analysis_stats": {"confirmed-timeout": 0, "failure": 0, "harmless": 0, "malicious": 61, "suspicious": 0, "timeout": 0, "type-unsupported": 5, "undetected": 10}, "last_modification_date": 1606911051, "last_submission_date": 1572934476, "magic": "PE32 executable for MS Windows (GUI) Intel 80386 32-bit", "md5": "9498ff82a64ff445398c8426exxxx", "meaningful_name": "ShellExtension", "names": ["ShellExtension", "ZeuS_binary_9498ff82a64ff445398c8426exxxx.exe", "9498ff82a64ff445398c8426exxxx.exe", "9498ff82a64ff445398c8426exxxx", "2420800", "8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdb1xxxxx.exe", "sigchxxx.exe", "malwxxx.exe"], "pe_info": {"compiler_product_versions": ["[C++] VS2010 SP1 build 40219 count=36", "[ASM] VS2010 SP1 build 40219 count=19", "[ C ] VS2010 SP1 build 40219 count=110", "[IMP] VS2008 SP1 build 30729 count=21", "[---] Unmarked objects count=197", "id: xxx, version: 40219 count=1", "[RES] VS2010 SP1 build 40219 count=1", "[LNK] VS2010 SP1 build 40219 count=1"], "entry_point": 14768, "imphash": "d7584447a5c5ca9b4a559463171xxxx", "import_list": [{"imported_functions": ["GetOpenFileNameA"], "library_name": "COMDLG32.dll"}, {"imported_functions": ["SafeArrayCreate", "RegisterActiveObject"], "library_name": "OLEAUT32.dll"}, {"imported_functions": ["GetObjectA", "CreateDCA", "AddFontResourceA", "DeleteObject", "CreateSolidBrush", "SetBkMode", "SetBkColor", "GetBitmapBits", "EnumFontFamiliesA"], "library_name": "GDI32.dll"}, {"imported_functions": ["SetSecurityDescriptorDacl", "GetTokenInformation", "ConvertStringSecurityDescriptorToSecurityDescriptorW", "OpenProcessToken", "InitializeSecurityDescriptor", "OpenThreadToken", "GetSecurityDescriptorSacl", "SetSecurityDescriptorSacl"], "library_name": "ADVAPI32.dll"}, {"imported_functions": ["GetStdHandle", "EncodePointer", "CreatePipe", "GetCurrentProcess", "GetConsoleMode", "GetLocaleInfoA", "LocalAlloc", "lstrcatA", "FreeEnvironmentStringsW", "SetStdHandle", "WideCharToMultiByte", "lstrcmpiA", "InterlockedExchange", "WriteFile", "GetTimeZoneInformation", "GetSystemTimeAsFileTime", "HeapReAlloc", "GetStringTypeW", "GetFullPathNameA", "LocalFree", "InitializeCriticalSection", "FindClose", "InterlockedDecrement", "FormatMessageA", "SetLastError", "GetModuleFileNameW", "IsDebuggerPresent", "HeapAlloc", "GetModuleFileNameA", "HeapSetInformation", "GetPrivateProfileStringA", "UnhandledExceptionFilter", "TlsGetValue", "MultiByteToWideChar", "CreateThread", "DeleteCriticalSection", "SetUnhandledExceptionFilter", "IsProcessorFeaturePresent", "DecodePointer", "SetEnvironmentVariableA", "TerminateProcess", "GetVersion", "GlobalAlloc", "GetCurrentThreadId", "InterlockedIncrement", "WriteConsoleW", "InitializeCriticalSectionAndSpinCount", "HeapFree", "EnterCriticalSection", "SetHandleCount", "TerminateThread", "LoadLibraryW", "GetVersionExW", "GetOEMCP", "QueryPerformanceCounter", "GetTickCount", "TlsAlloc", "FlushFileBuffers", "RtlUnwind", "DeleteFileA", "GetStartupInfoW", "GetProcAddress", "CompareStringW", "FindFirstFileA", "lstrcpyA", "FindNextFileA", "LocalSize", "CreateFileW", "GetFileType", "TlsSetValue", "CreateFileA", "ExitProcess", "LeaveCriticalSection", "GetLastError", "LCMapStringW", "lstrlenA", "GetConsoleCP", "GetEnvironmentStringsW", "GetCurrentProcessId", "GetCPInfo", "HeapSize", "GetCommandLineA", "GetCurrentThread", "TlsFree", "SetFilePointer", "CloseHandle", "GetACP", "GetModuleHandleW", "IsValidCodePage", "HeapCreate", "Sleep"], "library_name": "KERNEL32.dll"}, {"imported_functions": ["RasGetErrorStringA", "RasHangUpA"], "library_name": "RASAPI32.dll"}, {"imported_functions": ["EnumPrintersA", "GetPrinterDriverA", "OpenPrinterA", "SetPrinterDataExA", "DeviceCapabilitiesA", "ClosePrinter"], "library_name": "WINSPOOL.DRV"}, {"imported_functions": ["ExtractAssociatedIconA"], "library_name": "SHELL32.dll"}, {"imported_functions": ["SetFocus", "GetMessageA", "UpdateWindow", "EndDialog", "BeginPaint", "OffsetRect", "DrawIcon", "GetDlgCtrlID", "EnumWindowStationsW", "DefWindowProcA", "ShowWindow", "LoadBitmapA", "SetWindowPos", "GetWindowThreadProcessId", "SendDlgItemMessageA", "GetSystemMetrics", "IsWindow", "GetWindowRect", "DispatchMessageA", "EndPaint", "SetDlgItemTextA", "MoveWindow", "GetDlgItemTextA", "MessageBoxA", "TranslateMessage", "GetWindow", "GetSysColor", "SetActiveWindow", "GetDC", "RegisterClassExA", "GetCursorPos", "DdeInitializeA", "LoadBitmapW", "SetWindowTextA", "CheckMenuItem", "SendMessageW", "wsprintfA", "GetWindowPlacement", "SendMessageA", "GetClientRect", "GetDlgItem", "CreateDialogParamA", "SystemParametersInfoW", "IsIconic", "SetRect", "InvalidateRect", "GetSubMenu", "LoadCursorA", "LoadIconA", "FillRect", "IsDlgButtonChecked", "CheckDlgButton", "GetSysColorBrush", "CreateWindowExW", "EnableWindow", "SetForegroundWindow", "WindowFromDC", "DestroyWindow"], "library_name": "USER32.dll"}, {"imported_functions": ["ImageList_GetImageCount", "ImageList_Create", "ImageList_GetImageInfo", "ImageList_AddMasked"], "library_name": "COMCTL32.dll"}], "machine_type": 332, "resource_details": [{"chi2": 8137.34814453125, "entropy": 5.789552211761475, "filetype": "Data", "lang": "ENGLISH US", "sha256": "c37bc8f6dbf81e8d88978836b23ee932ade6652ba798989bf20697axxxx", "type": "RT_BITMAP"}, {"chi2": 32671.111328125, "entropy": 2.0749704837799072, "filetype": "Data", "lang": "ENGLISH US", "sha256": "9bf3939c91a904d9264930fc8a584a16286ce206b26b3f8387a8a14bxxxx", "type": "RT_BITMAP"}, {"chi2": 5212.0654296875, "entropy": 2.6772308349609375, "filetype": "Data", "lang": "ENGLISH US", "sha256": "201f2410710734df8e2f7ccbba51452e4d0ec8cc81fc57e08b117969xxxx", "type": "RT_MENU"}, {"chi2": 20196.896484375, "entropy": 2.846670150756836, "filetype": "Data", "lang": "RUSSIAN", "sha256": "de88d79a921d32d563d4448ee532b5d01f629a37ea8e877e1af3acxxxx", "type": "RT_DIALOG"}, {"chi2": 17094.91796875, "entropy": 3.271855354309082, "filetype": "Data", "lang": "ENGLISH US", "sha256": "851381c684c9f0c7b8cb7d0fb0cdf9837b6466b9923bebe0afdccb5dxxxx", "type": "RT_DIALOG"}, {"chi2": 59740.10546875, "entropy": 3.3894574642181396, "filetype": "Data", "lang": "ENGLISH US", "sha256": "a24783298e931e7949670435824fec4c4b4003f5d5d65f06fe1dcxxxx", "type": "RT_VERSION"}, {"chi2": 3958.6474609375, "entropy": 4.795973777770996, "filetype": "ASCII text", "lang": "ENGLISH US", "sha256": "49a60be4b95b6d30da355a0c124af82b35000bce8f24f957d1c09eaxxxx", "type": "RT_MANIFEST"}], "resource_langs": {"ENGLISH US": 6, "RUSSIAN": 1}, "resource_types": {"RT_BITMAP": 2, "RT_DIALOG": 2, "RT_MANIFEST": 1, "RT_MENU": 1, "RT_VERSION": 1}, "rich_pe_header_hash": "fa4dbca9180170710b3c245464exxxx", "sections": [{"chi2": 292981.44, "entropy": 6.75, "flags": "rx", "md5": "a13f88c3e0636712e10326c07d56xxxx", "name": ".text", "raw_size": 54784, "virtual_address": 4096, "virtual_size": 54434}, {"chi2": 343534.84, "entropy": 7.29, "flags": "r", "md5": "fa72929ef3859e79dcc5257ccbxxxx", "name": ".rdata", "raw_size": 94720, "virtual_address": 61440, "virtual_size": 94670}, {"chi2": 243416.81, "entropy": 7.58, "flags": "rw", "md5": "7320155c0175defb5b80cc0cd7xxxx", "name": ".data", "raw_size": 94208, "virtual_address": 159744, "virtual_size": 103244}, {"chi2": 99751.05, "entropy": 5.23, "flags": "r", "md5": "613c08f8546d75f1daf2a32b9b4xxxx", "name": ".rsrc", "raw_size": 3584, "virtual_address": 266240, "virtual_size": 3168}, {"chi2": 552797.69, "entropy": 3.88, "flags": "r", "md5": "4be0d54241ec8f62e48c40389cxxxx", "name": ".reloc", "raw_size": 6656, "virtual_address": 270336, "virtual_size": 6200}], "timestamp": 1410950077}, "reputation": -49, "sha1": "36f9ca40b3ce96fcee1cf1d4a722293553xxxx", "sha256": "8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdb1cxxxx", "sigma_analysis_stats": {"critical": 0, "high": 0, "low": 4, "medium": 0}, "sigma_analysis_summary": {"Sigma Integrated Rule Set (GitHub)": {"critical": 0, "high": 0, "low": 4, "medium": 0}}, "signature_info": {"copyright": "Copyright 2003-2013", "description": "WinMerge Shell Integration", "file version": "1.0.1.6", "internal name": "ShellExtension", "original name": "ShellExtension", "product": "ShellExtension"}, "size": 254976, "ssdeep": "6144:Gz90qLc1zR98hUb4UdjzEwG+vqAWiR4EXePbix67CNzjX:Gz90qLc1lWhUbhVqxxxx", "tags": ["peexe", "runtime-modules", "direct-cpu-clock-access"], "times_submitted": 8, "tlsh": "T1DB44CF267660D833D0DF94316C75C3F9673BFC2123215A6B6A4417699E307Exxxx", "total_votes": {"harmless": 2, "malicious": 7}, "trid": [{"file_type": "Win32 Executable MS Visual C++ (generic)", "probability": 54.3}, {"file_type": "Win16 NE executable (generic)", "probability": 12.2}, {"file_type": "Win32 Dynamic Link Library (generic)", "probability": 11.4}, {"file_type": "Win32 Executable (generic)", "probability": 7.8}, {"file_type": "OS/2 Executable (generic)", "probability": 3.5}], "type_description": "Win32 EXE", "type_extension": "exe", "type_tag": "peexe", "unique_sources": 8, "vhash": "025056657d755510804011z9005b9z25z1xxxx"}, "id": "8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdbxxxxx", "links": {"self": "https://www.virustotal.com/api/v3/files/8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdbxxxx"}, "type": "file", "comments": [{"attributes": {"date": 1595402790, "html": "#malware #Zeus<br /><br />Full genetic report from Intezer Analyze:<br />https://analyze.intezer.com/#/files/8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdbxxxx<br /><br />#IntezerAnalyze", "tags": ["malware", "zeus", "intezeranalyze"], "text": "#malware #Zeus\n\nFull genetic report from Intezer Analyze:\nhttps://analyze.intezer.com/#/files/8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdbxxxx\n\n#IntezerAnalyze", "votes": {"abuse": 0, "negative": 0, "positive": 0}}, "id": "f-8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdbxxxx-9945xxxx", "links": {"self": "https://www.virustotal.com/api/v3/comments/f-8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdbxxxx-9945xxx"}, "type": "comment"}], "widget_url": "https://www.virustotal.com/ui/widget/html/OGIyZTcwMWU5MTEwMTk1NWM3Mzg2NTU4OWE0YzcyOTk5YWVhYmMxMTA0M2Y3MTJlMDVmZGIxYzE3YzRhYjE5YXx8ZmlsZXx8eyJiZDEiOiAiIzRkNjM4NSIsICJiZzEiOiAiIzMxM2Q1YSIsICJiZzIiOiAiIzIyMmM0MiIsICJmZzEiOiAiI2ZmZmZmZiIsICJ0eXBlIjogImRlZmF1bHQifXx8ZnVsbHx8Zm91bmR8fDE2NDY2NzIzOTN8fGI5OWQ3MTY5MGIzZGY5MmVjMWExNTZlMmQ1MjM3OWJhMGMxYzgyZTAwMjVkMTJmZjg5MWM2YzdjNxxxxxxxxxx", "sandboxes_analysis":{"VirusTotal Jujubox":{"attributes":{"registry_keys_opened":["HKCU\\\\SOFTWARE\\\\Microsoft","SOFTWARE\\\\Microsoft\\\\Xuoc"],"calls_highlighted":["GetTickCount"],"tags":["DIRECT_CPU_CLOCK_ACCESS","RUNTIME_MODULES"],"files_written":["C:\\\\Users\\\\<USER>\\\\AppData\\\\Roaming\\\\Uwcyi\\\\xeysv.exe"],"mutexes_opened":["Local\\\\{159989F5-EED2-E258-7F7B-44xxxxxxxxxx}"],"modules_loaded":["ADVAPI32.dll"],"analysis_date":1593005327,"sandbox_name":"VirusTotal Jujubox","has_html_report":true,"behash":"891a0af66a031b044dce08xxxxxxxxxx","has_evtx":false,"text_highlighted":["C:\\\\Windows\\\\system32\\\\cmd.exe"],"last_modification_date":1593005327,"has_memdump":false,"mutexes_created":["Global\\\\{5995CC4B-E3B3-EBC8-9F85-4Bxxxxxxxxxx}"],"has_pcap":true,"files_opened":["C:\\\\Windows\\\\system32\\\\SXS.DLL"]},"type":"file_behaviour","id":"8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdb1xxxxxxxxxx_VirusTotal Jujubox","links":{"self":"https://www.virustotal.com/api/v3/file_behaviours/8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdb1xxxxxxxxxx_VirusTotal Jujubox"}},"Microsoft Sysinternals":{"attributes":{"command_executions":["C:\\\\Windows\\\\System32\\\\wuapihost.exe -Embedding"],"ip_traffic":[{"transport_layer_protocol":"UDP","destination_ip":"a83f:8110:xxxx:0:0:0:xx:xx","destination_port":53},{"transport_layer_protocol":"UDP","destination_ip":"a83f:8110:xxxx:d850:2821:d8ef:2821:xxxx","destination_port":53}],"processes_injected":["\\\\\\\\?\\\\C:\\\\Windows\\\\system32\\\\wbem\\\\WMIADAP.EXE"],"modules_loaded":["%SAMPLEPATH%\\\\ShellExtension.exe"],"has_pcap":false,"analysis_date":1634801121,"sandbox_name":"Microsoft Sysinternals","has_html_report":false,"processes_terminated":["%SAMPLEPATH%\\\\ShellExtension.exe"],"behash":"a83d640a282980db1dd43xxxxxxxxxxx","files_deleted":["C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\WER\\\\Temp\\\\WER2A57.tmp.WERInternalMetadata.xml"],"files_dropped":[{"path":"C:\\\\Windows\\\\System32\\\\spp\\\\store\\\\2.0\\\\data.dat.tmp"},{"path":"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\WER\\\\Temp\\\\WER2A57.tmp"}],"has_evtx":false,"last_modification_date":1647305697,"has_memdump":false,"processes_created":["%SAMPLEPATH%\\\\ShellExtension.exe"],"processes_tree":[{"process_id":"26xx","name":"%WINDIR%\\\\explorer.exe","children":[{"process_id":"35xx","name":"%SAMPLEPATH%\\\\ShellExtension.exe"}]},{"process_id":"61xx","name":"C:\\\\Windows\\\\System32\\\\svchost.exe","children":[{"process_id":"33xx","name":"C:\\\\Windows\\\\System32\\\\wuapihost.exe"}]}],"files_opened":["<Anonymous Pipe>"]},"type":"file_behaviour","id":"8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdb1xxxxxxxxxx_Microsoft Sysinternals","links":{"self":"https://www.virustotal.com/api/v3/file_behaviours/8b2e701e91101955c73865589a4c72999aeabc11043f712e05fdb1xxxxxxxxxx_Microsoft Sysinternals"}}}}}], "is_risky": true}
```



#### Get Related IPs
Get related IPs to the provided entities from VirusTotal. Note: this action requires a VT Enterprise token. Supported entities: URL, Filehash, Hostname. Note: only MD5, SHA-1 and SHA-256 are supported.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Results|Specify how the JSON result should look like. If "Combined" is selected then action will return all of the unique results that were found among the provided entities. If "Per Entity" is selected, then action will return all of the unique items per entity.|False|List|Combined|
|Max IPs To Return|Specify how many URLs to return. Depending on the parameter "Results", this parameter will behave differently. For "Combined" the limit will define how many results to return from ALL entities. For "Per Entity" this parameter dictates how many results to return per entity. Default: 40.|False|String|40|



##### JSON Results
```json
{"ips": ["72.21.xx.xx", "23.54.xx.xx", "169.254.xx.xx", "169.254.xx.xx", "192.168.xx.xx"],"EntityResults":[{"Entity":"https://docs.example.com/","EntityResult":["104.114.xx.xxx","23.66.xxx.xxx"]},{"Entity":"www.example.com","EntityResult":["93.184.xxx.xx","0.0.xx.xx"]}]}
```



#### Get Graph Details
Get detailed information about graphs in VirusTotal.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Graph ID|Specify a comma-separated list of graph ids for which you want to retrieve detailed information.|True|String||
|Max Links To Return|Specify how many links to return.|False|String|50|



##### JSON Results
```json
[{"attributes": {"comments_count": 0, "creation_date": 1561372988, "graph_data": {"description": "WannaCry", "version": "5.0.0"}, "last_modified_date": 1604654635, "links": [{"connection_type": "itw_domains", "source": "ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "target": "relationships_itw_domains_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx"}, {"connection_type": "itw_domains", "source": "relationships_itw_domains_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "target": "download.eu-west-3.fromsmash.co"}], "nodes": [{"entity_attributes": {"has_detections": true, "type_tag": "peexe"}, "entity_id": "ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "index": 0, "text": "WannaCry", "type": "file", "x": 165.34444655878607, "y": -193.3118919470504}, {"entity_attributes": {"has_detections": true, "type_tag": "peexe"}, "entity_id": "f0105b922f41b0ee8595e0e7d989c9ba69d4a38337211dcbe86e0xxxxxxx", "index": 59, "text": "", "type": "file", "x": 132.60777217135902, "y": -290.66187835602557}, {"entity_attributes": {"has_detections": true, "type_tag": "peexe"}, "entity_id": "1e06140672b73dfe337dfde7bc9dead5612bdbf4a8069be5de78fxxxxx", "index": 60, "text": "", "type": "file", "x": 141.39419531904667, "y": -302.35889366568784}, {"entity_attributes": {"has_detections": true, "type_tag": "peexe"}, "entity_id": "9021dd020a9b81172d24ed40fbbeacd54bf066c9061bed2xxxxxx", "index": 61, "text": "", "type": "file", "x": 114.82059942884831, "y": -293.56997811560984}, {"entity_attributes": {"has_detections": true, "type_tag": "peexe"}, "entity_id": "ae55d74a872e43887e742ff7116613f6d070a2e33d79f14cfxxxxx", "index": 62, "text": "", "type": "file", "x": 126.86409288335071, "y": -301.46251809050034}, {"entity_attributes": {"has_detections": true, "type_tag": "peexe"}, "entity_id": "ea03d23c039a0cab6e18f3b6b5085db5b08eb44766e473f56axxxxx", "index": 63, "text": "", "type": "file", "x": 156.72129220301676, "y": -303.5222755944866}, {"entity_attributes": {}, "entity_id": "www.ifferfsodp9ifjajhgosurijfaewrwxxxxx.com", "fx": 25.78605596600282, "fy": -406.15274163028903, "index": 64, "text": "Kill Switch", "type": "domain", "x": 25.78605596600282, "y": -406.15274163028903}, {"entity_attributes": {}, "entity_id": "relationships_itw_domains_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "index": 65, "text": "", "type": "relationship", "x": 220.98374993706935, "y": -174.52499019748032}, {"entity_attributes": {}, "entity_id": "relationships_embedded_domains_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "fx": 45, "fy": -66, "index": 66, "text": "", "type": "relationship", "x": 45, "y": -66}, {"entity_attributes": {}, "entity_id": "relationships_overlay_parents_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "fx": 249, "fy": -377, "index": 67, "text": "", "type": "relationship", "x": 249, "y": -377}, {"entity_attributes": {}, "entity_id": "relationships_pcap_parents_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "fx": 295, "fy": -71, "index": 68, "text": "", "type": "relationship", "x": 295, "y": -71}, {"entity_attributes": {}, "entity_id": "relationships_itw_urls_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "index": 69, "text": "", "type": "relationship", "x": 115.81335574307816, "y": -162.98602190650118}, {"entity_attributes": {}, "entity_id": "relationships_compressed_parents_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "index": 70, "text": "", "type": "relationship", "x": 211.62527508884813, "y": -234.43557262290537}, {"entity_attributes": {}, "entity_id": "relationships_contacted_ips_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "index": 71, "text": "", "type": "relationship", "x": 174.73575904497537, "y": -136.95921332562654}, {"entity_attributes": {}, "entity_id": "relationships_pe_resource_parents_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "index": 72, "text": "", "type": "relationship", "x": 109.52858763507761, "y": -229.70476261661278}, {"entity_attributes": {}, "entity_id": "relationships_execution_parents_ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5xxxxxxx", "index": 73, "text": "", "type": "relationship", "x": 143.3159050174847, "y": -252.85444757386298}, {"entity_attributes": {}, "entity_id": "relationships_contacted_domains_32f24601153be0885f11d62e0a8a2f0280a2034fc981dxxxxxxx", "index": 74, "text": "", "type": "relationship", "x": 58.34284702784282, "y": -343.70034091068004}], "position": {"scale": "1", "x": 510, "y": 729}, "private": false, "views_count": 130979}, "id": "g8a8c71844d5444f98fd3ef10e3ccc94f894c32f05f86417xxxx", "links": {"self": "https://www.virustotal.com/api/v3/graphs/g8a8c71844d5444f98fd3ef10e3ccc94f894c32f05f86417xxxx"}, "type": "graph"}]
```



#### Get Related Hashes
Get related hashes to the provided entities from VirusTotal. Note: this action requires a VT Enterprise token. Supported entities: IP, URL, Filehash, Hostname. Note: only MD5, SHA-1 and SHA-256 are supported.
Timeout - 600 Seconds


|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|Results|Specify how the JSON result should look like. If "Combined" is selected then action will return all of the unique results that were found among the provided entities. If "Per Entity" is selected, then action will return all of the unique items per entity.|False|List|Combined|
|Max Hashes To Return|Specify how many URLs to return. Depending on the parameter "Results", this parameter will behave differently. For "Combined" the limit will define how many results to return from ALL entities. For "Per Entity" this parameter dictates how many results to return per entity. Default: 40.|False|String|40|



##### JSON Results
```json
{"sha256_hashes": ["8b2e701e91101955c73865589a4c72999aeabc11043f712e0xxxxx", "0b01ec5df4dfdafc887303ac3d9c0ab1d13fd8aaf60499168fxxxx", "e23334f6454b5a889bb232211c4ec9df91a10e6c587ed20a9200xxxx", "cf29825d5b1bff484597c35f5b9e6c8e32068a0105715569xxxx", "729b785931e3acb5a45220c588f9f5a6638a2720ebb41fc606xxxx"],"EntityResults":[{"Entity":"HTTP://MARKOSSOLOMON.COM/F1Q7QX.PHP","EntityResult":["576448fd7f4d93f8b4def78755425580a1dfb9f7404d6c73378c74xxxxxxxxxx","69fb7b96d2da05f2aef88efc9e788ede343c9112ae164fe026e504xxxxxxxxxx"]},{"Entity":"192.xxx.xx.x","EntityResult":["81c1ecc1bbb512788887bcab692e6cd6a9a0ffc1f5620c3305c54dxxxxxxxxxx","e206fd22c59022f7ccf96f8b389fd78c07409adc1f9eb4ef2b2702xxxxxxxxxx"]}]}
```






## Jobs



## Connectors
#### VirusTotal - Livehunt Notifications Connector
Pull information about Livehunt notifications and related files from VirusTotal. Note: this connector requires a premium API token. Dynamic list works with "rule_name" parameter.

|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|DeviceProductField|Enter the source field name in order to retrieve the Product Field name.|True|String|Product Name|
|EventClassId|Enter the source field name in order to retrieve the Event Field name.|True|String|type|
|Environment Field Name|Describes the name of the field where the environment name is stored. If the environment field isn't found, the environment is the default environment.|False|String||
|Environment Regex Pattern|A regex pattern to run on the value found in the "Environment Field Name" field. Default is .* to catch all and return the value unchanged. Used to allow the user to manipulate the environment field via regex logic. If the regex pattern is null or empty, or the environment value is null, the final environment result is the default environment.|False|String|.*|
|PythonProcessTimeout|Timeout limit for the python process running the current script.|True|Integer|180|
|API Key|VirusTotal API Key.|True|Password||
|Verify SSL|If enabled, verify the SSL certificate for the connection to the VirusTotal server is valid.|False|Boolean|true|
|Engine Whitelist|Specify a comma-separated list of engines that should be used, when counting the \'Engine Percentage Threshold To Fetch\' parameter. Example: AlienVault,Kaspersky. Note: if nothing is provided, all engines from the response are counted.|False|String||
|Engine Percentage Threshold To Fetch|The percentage of engines that need to mark the file as suspicious/malicious before it's being ingested. Maximum value: 100. Minimum: 0.|True|Integer|0|
|Max Hours Backwards|Amount of hours from where to fetch notifications.|False|Integer|1|
|Max Notifications To Fetch|How many notifications to process per one connector iteration. Default: 40.|False|Integer|40|
|Use dynamic list as a blacklist|If enabled, dynamic lists will be used as a blacklist.|False|Boolean|false|
|Proxy Server Address|The address of the proxy server to use.|False|String||
|Proxy Username|The proxy username to authenticate with.|False|String||
|Proxy Password|The proxy password to authenticate with.|False|Password||


#### List Alerts Notifications
Get Livehunt Notifications

|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|DeviceProductField|Enter the source field name in order to retrieve the Product Field name.|True|String|Product Name|
|EventClassId|Enter the source field name in order to retrieve the Event Field name.|True|String|eventType|
|Environment Field Name|Describes the name of the field where the environment name is stored. If the environment field isn't found, the environment is the default environment.|False|String||
|Environment Regex Pattern|A regex pattern to run on the value found in the "Environment Field Name" field. Default is .* to catch all and return the value unchanged. Used to allow the user to manipulate the environment field via regex logic. If the regex pattern is null or empty, or the environment value is null, the final environment result is the default environment.|False|String|.*|
|PythonProcessTimeout|Timeout limit for the python process running the current script.|True|Integer|180|
|API Key|Specify the API Key.|True|Password||
|Verify SSL|If enabled, verify the SSL certificate for the connection to the Darktrace server is valid.|False|Boolean|true|
|Use whitelist as a blacklist|If enabled, whitelist will be used as a blacklist.|False|Boolean|false|
|Max Alerts Per Cycle|Specify how many alerts should be processed during one connector run.|True|Integer|10|
|Max Hours Backwards|Amount of hours from where to fetch model breaches.|True|Integer|1|
|Proxy Server Address|The address of the proxy server to use.|False|String||
|Proxy Username|The proxy username to authenticate with.|False|String||
|Proxy Password|The proxy password to authenticate with.|False|Password||


#### Livehunt Notifications Connector
Get Livehunt Notifications

|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|DeviceProductField|Enter the source field name in order to retrieve the Product Field name.|True|String|Product Name|
|EventClassId|Enter the source field name in order to retrieve the Event Field name.|True|String|eventType|
|Environment Field Name|Describes the name of the field where the environment name is stored. If the environment field isn't found, the environment is the default environment.|False|String||
|Environment Regex Pattern|A regex pattern to run on the value found in the "Environment Field Name" field. Default is .* to catch all and return the value unchanged. Used to allow the user to manipulate the environment field via regex logic. If the regex pattern is null or empty, or the environment value is null, the final environment result is the default environment.|False|String|.*|
|PythonProcessTimeout|Timeout limit for the python process running the current script.|True|Integer|180|
|API Key|Specify the API Key.|True|Password||
|Verify SSL|If enabled, verify the SSL certificate for the connection to the Darktrace server is valid.|False|Boolean|true|
|Use whitelist as a blacklist|If enabled, whitelist will be used as a blacklist.|False|Boolean|false|
|Max Alerts Per Cycle|Specify how many alerts should be processed during one connector run.|True|Integer|10|
|Max Hours Backwards|Amount of hours from where to fetch model breaches.|True|Integer|1|
|Proxy Server Address|The address of the proxy server to use.|False|String||
|Proxy Username|The proxy username to authenticate with.|False|String||
|Proxy Password|The proxy password to authenticate with.|False|Password||


#### IOC Connector
Query saved search with a timestamp iterator

|Name|Description|IsMandatory|Type|DefaultValue|
|----|-----------|-----------|----|------------|
|DeviceProductField|Enter the source field name in order to retrieve the Product Field name.|True|String|Product Name|
|EventClassId|Enter the source field name in order to retrieve the Event Field name.|True|String|eventType|
|Environment Field Name|Describes the name of the field where the environment name is stored. If the environment field isn't found, the environment is the default environment.|False|String||
|Environment Regex Pattern|A regex pattern to run on the value found in the "Environment Field Name" field. Default is .* to catch all and return the value unchanged. Used to allow the user to manipulate the environment field via regex logic. If the regex pattern is null or empty, or the environment value is null, the final environment result is the default environment.|False|String|.*|
|PythonProcessTimeout|Timeout limit for the python process running the current script.|True|Integer|180|
|API Key|Specify the API Key.|True|Password||
|Verify SSL|If enabled, verify the SSL certificate for the connection to the Darktrace server is valid.|False|Boolean|true|
|Query|Enter the query.|True|String||
|Use whitelist as a blacklist|If enabled, whitelist will be used as a blacklist.|False|Boolean|false|
|Max Alerts Per Cycle|Specify how many alerts should be processed during one connector run.|True|Integer|10|
|Max Hours Backwards|Amount of hours from where to fetch model breaches.|True|Integer|1|
|Proxy Server Address|The address of the proxy server to use.|False|String||
|Proxy Username|The proxy username to authenticate with.|False|String||
|Proxy Password|The proxy password to authenticate with.|False|Password||




